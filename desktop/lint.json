[{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\electron-main.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\preload.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\components\\AppLayout.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'updateApiUrl' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":13,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"updateApiUrl"},"fix":{"range":[737,751],"text":""},"desc":"Remove unused variable 'updateApiUrl'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'theme' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":13,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"theme"},"fix":{"range":[751,758],"text":""},"desc":"Remove unused variable 'theme'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'toggleTheme' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":13,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"toggleTheme"},"fix":{"range":[758,771],"text":""},"desc":"Remove unused variable 'toggleTheme'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'modalOverlayStyle' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":221,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":221,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"modalOverlayStyle"},"fix":{"range":[12750,12950],"text":""},"desc":"Remove unused variable 'modalOverlayStyle'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'labelStyle' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":222,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":222,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"labelStyle"},"fix":{"range":[12952,13123],"text":""},"desc":"Remove unused variable 'labelStyle'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useConfig } from '../context/ConfigContext';\r\nimport { IconBox, IconScan, IconSettings, IconCloud, IconUsers, IconBroadcast } from './Icons';\r\n\r\n// Simple Chevron Icons if not imported (assuming they might not exist in Icons.js, defining inline or using simple text if needed, but trying to use standard approach. \r\n// If Icons.js doesn't have them, I'll add SVGs directly).\r\n// Let's assume for now I should just use SVGs directly in the button to avoid import errors if they don't exist.\r\n\r\nconst AppLayout = ({ children }) => {\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const { apiUrl, updateApiUrl, theme, toggleTheme } = useConfig();\r\n    const [isCollapsed, setIsCollapsed] = useState(false);\r\n\r\n    const isActive = (path) => location.pathname === path;\r\n\r\n    const handleNavigation = (path) => {\r\n        navigate(path);\r\n        // setIsCollapsed(true); // Disable auto-collapse on navigation\r\n    };\r\n\r\n    return (\r\n        <div style={{ display: 'flex', height: '100vh', background: 'var(--bg-primary)', overflow: 'hidden' }}>\r\n\r\n            {/* --- SIDEBAR --- */}\r\n            <aside style={{\r\n                width: isCollapsed ? '80px' : '280px',\r\n                background: 'var(--bg-secondary)',\r\n                borderRight: '1px solid var(--border-color)',\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                zIndex: 10,\r\n                boxShadow: '4px 0 24px rgba(0,0,0,0.2)',\r\n                transition: 'width 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\r\n                position: 'relative'\r\n            }}>\r\n                {/* Toggle Button */}\r\n                <button\r\n                    onClick={() => setIsCollapsed(!isCollapsed)}\r\n                    style={{\r\n                        position: 'absolute',\r\n                        right: '-12px',\r\n                        top: '32px',\r\n                        width: '24px',\r\n                        height: '24px',\r\n                        background: 'var(--bg-primary)',\r\n                        border: '1px solid var(--border-color)',\r\n                        borderRadius: '50%',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n                        cursor: 'pointer',\r\n                        zIndex: 20,\r\n                        color: 'var(--text-secondary)',\r\n                        boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\r\n                    }}\r\n                >\r\n                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                        {isCollapsed ? <polyline points=\"9 18 15 12 9 6\" /> : <polyline points=\"15 18 9 12 15 6\" />}\r\n                    </svg>\r\n                </button>\r\n\r\n                <div style={{\r\n                    padding: isCollapsed ? '2rem 0' : '2rem 1.5rem',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '1rem',\r\n                    justifyContent: isCollapsed ? 'center' : 'flex-start',\r\n                    transition: 'all 0.3s ease',\r\n                    overflow: 'hidden',\r\n                    whiteSpace: 'nowrap'\r\n                }} className=\"app-region-drag\">\r\n                    <img src=\"/logo.svg\" alt=\"Prodexa\" style={{ width: isCollapsed ? '40px' : '56px', height: isCollapsed ? '40px' : '56px', transition: 'all 0.3s ease' }} />\r\n                    <div style={{\r\n                        display: 'flex',\r\n                        flexDirection: 'column',\r\n                        gap: '2px',\r\n                        opacity: isCollapsed ? 0 : 1,\r\n                        width: isCollapsed ? 0 : 'auto',\r\n                        transition: 'opacity 0.2s ease, width 0.3s ease'\r\n                    }}>\r\n                        <span style={{ fontWeight: '800', fontSize: '1.4rem', letterSpacing: '-0.02em', lineHeight: '1', color: 'var(--text-primary)' }}>Prodexa</span>\r\n                        <span style={{ fontSize: '0.6rem', fontWeight: '600', color: 'var(--text-secondary)', opacity: 0.8, letterSpacing: '0.02em' }}>WAREHOUSE OPERATIONS</span>\r\n                        <span style={{ fontSize: '0.65rem', fontWeight: '700', color: 'var(--accent-color)', letterSpacing: '0.05em', marginTop: '2px' }}>SRI LAKSHMI TEXTILES</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ flex: 1, paddingTop: '1rem', overflowY: 'auto', overflowX: 'hidden' }} className=\"app-region-no-drag sidebar-scroll\">\r\n                    <div style={{\r\n                        padding: isCollapsed ? '0' : '0 1.5rem 0.5rem',\r\n                        fontSize: '0.65rem',\r\n                        fontWeight: '800',\r\n                        color: 'var(--text-secondary)',\r\n                        letterSpacing: '0.1em',\r\n                        textAlign: isCollapsed ? 'center' : 'left',\r\n                        height: '1.5em',\r\n                        opacity: isCollapsed ? 0 : 1, // Hide section headers when collapsed\r\n                        transition: 'opacity 0.2s ease'\r\n                    }}>\r\n                        {!isCollapsed && 'MAIN NAVIGATION'}\r\n                    </div>\r\n                    <nav style={{ display: 'flex', flexDirection: 'column', gap: '4px', alignItems: 'center' }}>\r\n                        <SidebarLink collapsed={isCollapsed} active={isActive('/dashboard')} onClick={() => handleNavigation('/dashboard')} icon={<IconCloud />} label=\"Operations Dashboard\" />\r\n                        <SidebarLink collapsed={isCollapsed} active={isActive('/sessions')} onClick={() => handleNavigation('/sessions')} icon={<IconBroadcast />} label=\"Active Sessions\" />\r\n\r\n                        <SidebarLink collapsed={isCollapsed} active={isActive('/barcode')} onClick={() => handleNavigation('/barcode')} icon={<IconScan />} label=\"Barcode Generator\" />\r\n                        <SidebarLink collapsed={isCollapsed} active={isActive('/scanners')} onClick={() => handleNavigation('/scanners')} icon={<IconSettings />} label=\"Scanner Devices\" />\r\n                    </nav>\r\n\r\n                    <div style={{\r\n                        padding: isCollapsed ? '0' : '2rem 1.5rem 0.5rem',\r\n                        fontSize: '0.65rem',\r\n                        fontWeight: '800',\r\n                        color: 'var(--text-secondary)',\r\n                        letterSpacing: '0.1em',\r\n                        textAlign: isCollapsed ? 'center' : 'left',\r\n                        height: isCollapsed ? '1rem' : 'auto',\r\n                        opacity: isCollapsed ? 0 : 1, // Hide section headers when collapsed\r\n                        transition: 'opacity 0.2s ease',\r\n                        marginTop: isCollapsed ? '1rem' : '0'\r\n                    }}>\r\n                        {!isCollapsed && 'CONFIGURATION'}\r\n                    </div>\r\n                    <nav style={{ display: 'flex', flexDirection: 'column', gap: '4px', alignItems: 'center' }}>\r\n                        <SidebarLink collapsed={isCollapsed} active={isActive('/employees')} onClick={() => handleNavigation('/employees')} icon={<IconUsers />} label=\"Employee Management\" />\r\n                        <SidebarLink collapsed={isCollapsed} active={isActive('/configuration')} onClick={() => handleNavigation('/configuration')} icon={<IconSettings />} label=\"Article Sizes\" />\r\n                        <SidebarLink collapsed={isCollapsed} active={isActive('/settings')} onClick={() => handleNavigation('/settings')} icon={<IconSettings />} label=\"System Settings\" />\r\n                    </nav>\r\n                </div>\r\n\r\n                <div style={{ marginTop: 'auto', padding: isCollapsed ? '1.5rem 0' : '1.5rem', borderTop: '1px solid var(--border-color)', display: 'flex', justifyContent: 'center' }}>\r\n                    <button\r\n                        onClick={async () => {\r\n                            try {\r\n                                await fetch(`${apiUrl}/api/logout`, { method: 'POST' });\r\n                            } catch (e) { console.error('Logout error:', e); }\r\n                            localStorage.clear();\r\n                            navigate('/');\r\n                        }}\r\n                        className=\"sidebar-item\"\r\n                        style={{\r\n                            width: isCollapsed ? '40px' : '100%',\r\n                            height: isCollapsed ? '40px' : 'auto',\r\n                            display: 'flex', alignItems: 'center', gap: '1rem',\r\n                            padding: isCollapsed ? '0' : '0.8rem 1.5rem',\r\n                            border: '1px solid transparent',\r\n                            background: 'rgba(239, 68, 68, 0.05)',\r\n                            color: 'var(--error-color)',\r\n                            fontWeight: '700',\r\n                            borderRadius: '8px',\r\n                            cursor: 'pointer',\r\n                            justifyContent: isCollapsed ? 'center' : 'flex-start',\r\n                            transition: 'all 0.2s',\r\n                            overflow: 'hidden'\r\n                        }}\r\n                        title=\"Log Out\"\r\n                    >\r\n                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" style={{ minWidth: '20px' }}><path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\" /><polyline points=\"16 17 21 12 16 7\" /><line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\" /></svg>\r\n                        <span style={{\r\n                            fontSize: '0.9rem',\r\n                            opacity: isCollapsed ? 0 : 1,\r\n                            width: isCollapsed ? 0 : 'auto',\r\n                            transition: 'opacity 0.2s ease',\r\n                            whiteSpace: 'nowrap'\r\n                        }}>LOG OUT</span>\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* --- MAIN CONTENT WRAPPER --- */}\r\n            <div style={{ flex: 1, display: 'flex', flexDirection: 'column', overflow: 'hidden', background: 'var(--bg-primary)' }}>\r\n                {children}\r\n            </div>\r\n\r\n            {/* --- MODALS --- */}\r\n            <style>{`\r\n                .sidebar-scroll::-webkit-scrollbar { width: 4px; }\r\n                .sidebar-scroll::-webkit-scrollbar-track { background: transparent; }\r\n                .sidebar-scroll::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }\r\n                .sidebar-scroll::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }\r\n\r\n                .sidebar-item { transition: all 0.2s ease; opacity: 0.8; }\r\n                .sidebar-item:hover { opacity: 1; background: var(--bg-primary) !important; transform: translateX(isCollapsed ? 0 : 4px); }\r\n                .sidebar-item.active { opacity: 1; background: var(--bg-primary) !important; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst SidebarLink = ({ icon, label, active, onClick, collapsed }) => (\r\n    <button\r\n        onClick={onClick}\r\n        className={`sidebar-item ${active ? 'active' : ''}`}\r\n        title={collapsed ? label : ''}\r\n        style={{\r\n            display: 'flex', alignItems: 'center', gap: '1rem',\r\n            padding: collapsed ? '0.9rem 0' : '0.9rem 1.5rem',\r\n            justifyContent: collapsed ? 'center' : 'flex-start',\r\n            border: '1px solid transparent',\r\n            background: active ? 'var(--bg-primary)' : 'transparent',\r\n            color: active ? 'var(--accent-color)' : 'var(--text-secondary)',\r\n            fontWeight: active ? '700' : '600',\r\n            cursor: 'pointer', textAlign: 'left',\r\n            borderRadius: '12px', margin: '2px 0',\r\n            width: collapsed ? '48px' : '95%',\r\n            fontSize: '0.95rem',\r\n            transition: 'all 0.2s ease',\r\n        }}\r\n    >\r\n        {React.cloneElement(icon, { stroke: active ? 'var(--accent-color)' : 'currentColor', strokeWidth: active ? 2.5 : 2, style: { minWidth: '24px' } })}\r\n        <span style={{\r\n            opacity: collapsed ? 0 : 1,\r\n            width: collapsed ? 0 : 'auto',\r\n            overflow: 'hidden',\r\n            whiteSpace: 'nowrap',\r\n            transition: 'opacity 0.2s ease, width 0.2s ease'\r\n        }}>{label}</span>\r\n        {active && !collapsed && <div style={{ marginLeft: 'auto', width: '6px', height: '6px', borderRadius: '50%', background: 'var(--accent-color)' }}></div>}\r\n    </button>\r\n);\r\n\r\nconst modalOverlayStyle = { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'var(--modal-overlay)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 };\r\nconst labelStyle = { display: 'block', marginBottom: '0.4rem', fontSize: '0.75rem', fontWeight: '700', textTransform: 'uppercase', letterSpacing: '0.05em', opacity: 0.6 };\r\n\r\nexport default AppLayout;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\components\\Icons.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\context\\ConfigContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":45,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":45,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useState, useContext, useEffect } from 'react';\r\n\r\nconst ConfigContext = createContext();\r\n\r\nexport const ConfigProvider = ({ children }) => {\r\n    // Default to localhost for better reliability out-of-the-box\r\n    const [apiUrl, setApiUrl] = useState(localStorage.getItem('API_URL') || 'https://localhost:5000');\r\n\r\n    const updateApiUrl = (newUrl) => {\r\n        // Strip existing protocol and whitespace\r\n        let cleaned = newUrl.trim().replace(/^https?:\\/\\//, '');\r\n\r\n        // Remove double slash if user typed it by accident (e.g. stock-system.local//)\r\n        cleaned = cleaned.replace(/\\/{2,}/g, '/');\r\n\r\n        // Ensure PORT if missing (assume 5000)\r\n        if (!cleaned.includes(':')) cleaned = `${cleaned}:5000`;\r\n\r\n        // Reconstruct strict HTTPS URL\r\n        const formatted = `https://${cleaned}`;\r\n\r\n        setApiUrl(formatted);\r\n        localStorage.setItem('API_URL', formatted);\r\n    };\r\n\r\n    // Theme\r\n    const [theme, setTheme] = useState(localStorage.getItem('THEME') || 'light');\r\n\r\n    useEffect(() => {\r\n        document.body.setAttribute('data-theme', theme);\r\n        localStorage.setItem('THEME', theme);\r\n    }, [theme]);\r\n\r\n    const toggleTheme = () => {\r\n        setTheme(prev => prev === 'dark' ? 'light' : 'dark');\r\n    };\r\n\r\n    return (\r\n        <ConfigContext.Provider value={{ apiUrl, updateApiUrl, theme, toggleTheme }}>\r\n            {children}\r\n        </ConfigContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useConfig = () => useContext(ConfigContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\BarcodeGenerator.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'navigate' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":11,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[386,417],"text":""},"desc":"Remove unused variable 'navigate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setYear' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":12,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"setYear"},"fix":{"range":[434,443],"text":""},"desc":"Remove unused variable 'setYear'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchSizes' and 'size'. Either include them or remove the dependency array.","line":34,"column":8,"nodeType":"ArrayExpression","endLine":34,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [apiUrl, fetchSizes, size]","fix":{"range":[1413,1421],"text":"[apiUrl, fetchSizes, size]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchMissing' and 'fetchSequence'. Either include them or remove the dependency array.","line":48,"column":8,"nodeType":"ArrayExpression","endLine":48,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [year, size, apiUrl, fetchSequence, fetchMissing]","fix":{"range":[1891,1911],"text":"[year, size, apiUrl, fetchSequence, fetchMissing]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport jsPDF from 'jspdf';\r\nimport JsBarcode from 'jsbarcode';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { io } from \"socket.io-client\";\r\nimport { useConfig } from '../context/ConfigContext';\r\nimport { IconBox } from '../components/Icons';\r\n\r\nconst BarcodeGenerator = () => {\r\n    const { apiUrl } = useConfig();\r\n    const navigate = useNavigate();\r\n    const [year, setYear] = useState(new Date().getFullYear());\r\n    // Auto-format year to 2-digits if needed, but usually full year is stored, displayed as 2-digit\r\n    const displayYear = String(year).slice(-2);\r\n\r\n    const [size, setSize] = useState('');\r\n    const [quantity, setQuantity] = useState(24);\r\n    const [seqInfo, setSeqInfo] = useState({ lastSequence: 0, nextSequence: 1 });\r\n    const [missingBarcodes, setMissingBarcodes] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [seqLoading, setSeqLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [successMsg, setSuccessMsg] = useState('');\r\n\r\n    const [sizes, setSizes] = useState([]);\r\n    const MAX_PER_PAGE = 96; // 4 full pages of 24\r\n\r\n    useEffect(() => {\r\n        fetchSizes().then((data) => {\r\n            if (data && data.length > 0 && !size) {\r\n                // Trigger sequence fetch after setting size if not set\r\n            }\r\n        });\r\n    }, [apiUrl]);\r\n\r\n    useEffect(() => {\r\n        if (!size) return;\r\n        fetchSequence();\r\n        fetchMissing();\r\n\r\n        const socket = io(apiUrl);\r\n        socket.on('sequence_update', (data) => {\r\n            if (String(data.year) === String(year) && String(data.size) === String(size)) {\r\n                setSeqInfo({ lastSequence: data.lastSequence, nextSequence: data.lastSequence + 1 });\r\n            }\r\n        });\r\n        return () => socket.disconnect();\r\n    }, [year, size, apiUrl]);\r\n\r\n    const fetchSizes = async () => {\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sizes`);\r\n            const data = await res.json();\r\n            setSizes(data.map(s => s.code));\r\n            if (data.length > 0 && !size) {\r\n                setSize(data[0].code);\r\n            }\r\n            return data;\r\n        } catch (err) { console.error(\"Failed to fetch sizes\", err); return []; }\r\n    };\r\n\r\n    const fetchSequence = async () => {\r\n        setSeqLoading(true);\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/barcode/sequence?year=${year}&size=${size}`);\r\n            const data = await res.json();\r\n            if (!data.error) setSeqInfo(data);\r\n        } catch (err) { console.error(err); }\r\n        finally { setSeqLoading(false); }\r\n    };\r\n\r\n    const fetchMissing = async () => {\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/barcode/missing?year=${year}&size=${size}`);\r\n            const data = await res.json();\r\n            if (data.missing) setMissingBarcodes(data.missing);\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    const generatePDF = (barcodes) => {\r\n        const doc = new jsPDF();\r\n        const cols = 3;\r\n        const rowsPerPage = 8;\r\n        const startX = 15;\r\n        const startY = 15;\r\n        const cellWidth = 60;\r\n        const cellHeight = 34;\r\n\r\n        barcodes.forEach((item, index) => {\r\n            const pageIndex = index % (cols * rowsPerPage);\r\n            if (index > 0 && pageIndex === 0) {\r\n                doc.addPage();\r\n            }\r\n\r\n            const col = pageIndex % cols;\r\n            const row = Math.floor(pageIndex / cols);\r\n            const x = startX + (col * cellWidth);\r\n            const y = startY + (row * cellHeight);\r\n\r\n            const canvas = document.createElement('canvas');\r\n            JsBarcode(canvas, item.full_barcode, {\r\n                format: \"CODE128\", width: 4, height: 80, displayValue: true, fontSize: 20, fontOptions: \"bold\", margin: 10, textMargin: 5\r\n            });\r\n\r\n            doc.addImage(canvas.toDataURL(\"image/png\"), 'PNG', x, y, 50, 25);\r\n            doc.setDrawColor(230);\r\n            doc.setLineWidth(0.1);\r\n            doc.rect(x, y, 50, 25);\r\n        });\r\n        doc.save(`PRO_Barcodes_${year}_${size}_${Date.now()}.pdf`);\r\n    };\r\n\r\n    const handleGenerate = async () => {\r\n        setError(''); setSuccessMsg('');\r\n        if (quantity > MAX_PER_PAGE) return setError(`Current system batch limit is ${MAX_PER_PAGE} units.`);\r\n\r\n        setLoading(true);\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/barcode/generate`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ year, size, quantity })\r\n            });\r\n            const data = await res.json();\r\n            if (!res.ok) throw new Error(data.error);\r\n            generatePDF(data.barcodes);\r\n            setSuccessMsg(`Production batch created: ${data.barcodes.length} Barcodes exported.`);\r\n            fetchSequence(); // Refresh header\r\n            fetchMissing(); // Refresh missing list\r\n        } catch (err) { setError(err.message); }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const labelStyle = { display: 'block', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '0.5rem' };\r\n    const inputStyle = { width: '100%', padding: '0.9rem', borderRadius: '8px', border: '1px solid var(--border-color)', background: 'var(--bg-primary)', color: 'var(--text-primary)', fontSize: '0.95rem', fontWeight: '500' };\r\n\r\n    return (\r\n        <div style={{ padding: '0', height: '100%', display: 'flex', flexDirection: 'column', background: 'var(--bg-primary)' }} className=\"animate-fade-in\">\r\n            {/* Header */}\r\n            <header style={{\r\n                padding: '1.5rem 2.5rem',\r\n                background: 'var(--bg-secondary)',\r\n                borderBottom: '1px solid var(--border-color)',\r\n                display: 'flex', justifyContent: 'space-between', alignItems: 'center'\r\n            }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1.5rem' }}>\r\n                    <div style={{\r\n                        width: '48px', height: '48px', borderRadius: '12px',\r\n                        background: 'var(--bg-tertiary)', color: 'var(--text-primary)',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                    }}>\r\n                        <IconBox />\r\n                    </div>\r\n                    <div>\r\n                        <div style={{ color: 'var(--accent-color)', fontWeight: '700', fontSize: '0.75rem', letterSpacing: '0.1em', marginBottom: '0.2rem' }}>LOGISTICS & TRACKING</div>\r\n                        <h1 style={{ fontSize: '1.5rem', fontWeight: '800', margin: 0, letterSpacing: '-0.02em', color: 'var(--text-primary)' }}>\r\n                            Barcode Generation\r\n                        </h1>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <div style={{ flex: 1, padding: '2rem 2.5rem', overflowY: 'auto' }}>\r\n                <div style={{ maxWidth: '1000px', margin: '0 auto' }}>\r\n\r\n                    {/* Stats Grid */}\r\n                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '2rem', marginBottom: '2rem' }}>\r\n                        <div className=\"panel\" style={{\r\n                            padding: '1.5rem', background: 'var(--bg-secondary)',\r\n                            borderLeft: '4px solid var(--accent-color)', borderRadius: '12px',\r\n                            border: '1px solid var(--border-color)', borderLeftWidth: '4px'\r\n                        }}>\r\n                            <div style={{ fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em' }}>\r\n                                Last Registered Unit\r\n                            </div>\r\n                            <div style={{ fontSize: '2.5rem', fontWeight: '800', fontFamily: 'monospace', marginTop: '0.5rem', color: 'var(--text-primary)' }}>\r\n                                {seqLoading ? '...' : String(seqInfo.lastSequence).padStart(4, '0')}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"panel\" style={{\r\n                            padding: '1.5rem', background: 'var(--bg-secondary)',\r\n                            borderLeft: '4px solid var(--success-color)', borderRadius: '12px',\r\n                            border: '1px solid var(--border-color)', borderLeftWidth: '4px'\r\n                        }}>\r\n                            <div style={{ fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em' }}>\r\n                                Next Available Sequence\r\n                            </div>\r\n                            <div style={{ fontSize: '2.5rem', fontWeight: '800', fontFamily: 'monospace', marginTop: '0.5rem', color: 'var(--success-color)' }}>\r\n                                {seqLoading ? '...' : String(seqInfo.nextSequence).padStart(4, '0')}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Configuration Panel */}\r\n                    <div className=\"panel\" style={{ padding: '0', background: 'var(--bg-secondary)', borderRadius: '16px', border: '1px solid var(--border-color)', overflow: 'hidden' }}>\r\n                        <div style={{ padding: '1.5rem', borderBottom: '1px solid var(--border-color)' }}>\r\n                            <h3 style={{ margin: 0, fontSize: '1.1rem', color: 'var(--text-primary)' }}>Batch Configuration</h3>\r\n                            <p style={{ margin: '0.5rem 0 0', fontSize: '0.8rem', color: 'var(--text-secondary)' }}>\r\n                                Configure print parameters for new barcode sequence generation.\r\n                            </p>\r\n                        </div>\r\n\r\n                        <div style={{ padding: '2rem' }}>\r\n                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '2rem', marginBottom: '2.5rem' }}>\r\n\r\n                                <div>\r\n                                    <label style={labelStyle}>Fiscal Year (YY)</label>\r\n                                    <div style={{ position: 'relative' }}>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={displayYear}\r\n                                            readOnly\r\n                                            disabled\r\n                                            style={{ ...inputStyle, background: 'var(--bg-tertiary)', opacity: 0.7, cursor: 'not-allowed', fontFamily: 'monospace', fontWeight: '700' }}\r\n                                        />\r\n                                        <div style={{ position: 'absolute', right: '12px', top: '50%', transform: 'translateY(-50%)', fontSize: '0.8rem', color: 'var(--text-secondary)' }}>LOCKED</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label style={labelStyle}>Article Size Code</label>\r\n                                    <div style={{ position: 'relative' }}>\r\n                                        <select\r\n                                            value={size}\r\n                                            onChange={(e) => setSize(e.target.value)}\r\n                                            style={{ ...inputStyle, cursor: 'pointer', appearance: 'none' }}\r\n                                        >\r\n                                            {sizes.map(s => <option key={s} value={s}>{s}</option>)}\r\n                                        </select>\r\n                                        <div style={{ position: 'absolute', right: '12px', top: '50%', transform: 'translateY(-50%)', pointerEvents: 'none', color: 'var(--text-secondary)' }}>Γû╝</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label style={labelStyle}>Batch Quantity (Units)</label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={quantity}\r\n                                        min=\"1\"\r\n                                        max={MAX_PER_PAGE}\r\n                                        onChange={(e) => setQuantity(parseInt(e.target.value) || '')}\r\n                                        style={inputStyle}\r\n                                    />\r\n                                    <p style={{ fontSize: '0.75rem', color: 'var(--text-secondary)', marginTop: '0.5rem' }}>\r\n                                        Max Limit: {MAX_PER_PAGE} units per batch\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Integrity Alert */}\r\n                            {missingBarcodes.length > 0 && (\r\n                                <div style={{ background: 'rgba(239, 68, 68, 0.1)', border: '1px solid var(--error-color)', padding: '1.5rem', borderRadius: '12px', marginBottom: '2rem' }}>\r\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '1rem' }}>\r\n                                        <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--error-color)', color: 'white', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '0.9rem', fontWeight: 'bold' }}>!</div>\r\n                                        <h4 style={{ color: 'var(--error-color)', margin: 0, fontSize: '0.95rem', fontWeight: '700' }}>INTEGRITY ALERT: Sequence Gap Detected</h4>\r\n                                    </div>\r\n                                    <p style={{ fontSize: '0.85rem', marginBottom: '1rem', color: 'var(--text-secondary)' }}>\r\n                                        The system detected missing sequences in the current parameter set. These should be regenerated to maintain continuity.\r\n                                    </p>\r\n                                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>\r\n                                        {missingBarcodes.map(b => (\r\n                                            <span key={b.full_barcode} style={{\r\n                                                background: 'var(--bg-primary)', border: '1px solid var(--border-color)',\r\n                                                padding: '4px 10px', borderRadius: '6px', fontSize: '0.8rem',\r\n                                                fontFamily: 'monospace', fontWeight: '700', color: 'var(--text-primary)'\r\n                                            }}>\r\n                                                {b.full_barcode}\r\n                                            </span>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {error && (\r\n                                <div style={{ background: 'var(--error-bg)', color: 'var(--error-color)', padding: '1rem', borderRadius: '8px', marginBottom: '1.5rem', fontSize: '0.85rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\r\n                                    <span>ΓÜá∩╕Å</span> {error}\r\n                                </div>\r\n                            )}\r\n\r\n                            {successMsg && (\r\n                                <div style={{ background: 'var(--success-bg)', color: 'var(--success-color)', padding: '1rem', borderRadius: '8px', marginBottom: '1.5rem', fontSize: '0.85rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\r\n                                    <span>Γ£à</span> {successMsg}\r\n                                </div>\r\n                            )}\r\n\r\n                            <button\r\n                                onClick={handleGenerate}\r\n                                disabled={loading || !quantity}\r\n                                className=\"btn btn-primary\"\r\n                                style={{\r\n                                    width: '100%', padding: '1.25rem', fontSize: '1rem', fontWeight: '700', letterSpacing: '0.02em',\r\n                                    display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.75rem',\r\n                                    opacity: loading || !quantity ? 0.7 : 1, cursor: loading || !quantity ? 'not-allowed' : 'pointer'\r\n                                }}\r\n                            >\r\n                                {loading ? (\r\n                                    <>\r\n                                        <div className=\"spinner\" style={{ width: '20px', height: '20px', border: '3px solid rgba(255,255,255,0.3)', borderTopColor: 'white', borderRadius: '50%' }}></div>\r\n                                        <span>PROCESSING SECURE EXPORT...</span>\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <span>GENERATE PRODUCTION PDF</span>\r\n                                    </>\r\n                                )}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <style>{`\r\n                .spinner { animation: spin 1s linear infinite; }\r\n                @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BarcodeGenerator;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Configuration.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":166,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":166,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, memo } from 'react';\r\nimport { useConfig } from '../context/ConfigContext';\r\nimport { IconSettings, IconTrash, IconCloud } from '../components/Icons';\r\n\r\n// Styled Components / Variables\r\nconst thStyle = {\r\n    padding: '1rem 1.5rem', textAlign: 'left', fontWeight: '800', fontSize: '0.75rem',\r\n    color: 'var(--text-secondary)', letterSpacing: '0.05em', textTransform: 'uppercase'\r\n};\r\nconst tdStyle = {\r\n    padding: '1rem 1.5rem', borderBottom: '1px solid var(--border-color)', verticalAlign: 'middle'\r\n};\r\n\r\nconst SizeTable = memo(({ sizes, onDelete }) => {\r\n    return (\r\n        <div style={{ overflowX: 'auto' }}>\r\n            <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>\r\n                <thead style={{ background: 'var(--bg-secondary)', borderBottom: '1px solid var(--border-color)' }}>\r\n                    <tr>\r\n                        <th style={thStyle}>SIZE CODE</th>\r\n                        <th style={{ ...thStyle, textAlign: 'center' }}>TOTAL BARCODES</th>\r\n                        <th style={{ ...thStyle, textAlign: 'center' }}>IN STOCK</th>\r\n                        <th style={{ ...thStyle, textAlign: 'center' }}>DISPATCHED</th>\r\n                        <th style={{ ...thStyle, textAlign: 'right' }}>ACTIONS</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {sizes.length === 0 ? (\r\n                        <tr>\r\n                            <td colSpan=\"5\" style={{ textAlign: 'center', padding: '3rem', color: 'var(--text-secondary)' }}>\r\n                                <div style={{ fontSize: '2rem', marginBottom: '1rem', opacity: 0.5 }}>≡ƒôÅ</div>\r\n                                No size codes configured. Add a size on the right to get started.\r\n                            </td>\r\n                        </tr>\r\n                    ) : sizes.map((size, i) => {\r\n                        const stats = size.stats || { generated: 0, inStock: 0, outStock: 0 };\r\n                        const canDelete = stats.generated === 0 && stats.inStock === 0 && stats.outStock === 0;\r\n\r\n                        return (\r\n                            <tr key={size._id} style={{\r\n                                borderBottom: '1px solid var(--border-color)',\r\n                                background: i % 2 === 0 ? 'transparent' : 'rgba(0,0,0,0.02)',\r\n                                transition: 'all 0.2s'\r\n                            }}>\r\n                                <td style={{ ...tdStyle, fontWeight: '700', fontSize: '1rem', fontFamily: 'monospace', color: 'var(--text-primary)' }}>\r\n                                    {size.code}\r\n                                </td>\r\n                                <td style={{ ...tdStyle, textAlign: 'center' }}>\r\n                                    <span style={{\r\n                                        background: 'var(--bg-tertiary)', padding: '4px 12px', borderRadius: '12px',\r\n                                        fontSize: '0.85rem', fontWeight: '600', color: 'var(--text-secondary)'\r\n                                    }}>\r\n                                        {stats.generated}\r\n                                    </span>\r\n                                </td>\r\n                                <td style={{ ...tdStyle, textAlign: 'center' }}>\r\n                                    {stats.inStock > 0 ? (\r\n                                        <span style={{\r\n                                            color: 'var(--success-color)', background: 'var(--success-bg)',\r\n                                            padding: '4px 12px', borderRadius: '12px', fontWeight: '700', fontSize: '0.85rem'\r\n                                        }}>\r\n                                            {stats.inStock}\r\n                                        </span>\r\n                                    ) : <span style={{ opacity: 0.3 }}>-</span>}\r\n                                </td>\r\n                                <td style={{ ...tdStyle, textAlign: 'center' }}>\r\n                                    {stats.outStock > 0 ? (\r\n                                        <span style={{\r\n                                            color: 'var(--accent-color)', background: 'var(--accent-bg)',\r\n                                            padding: '4px 12px', borderRadius: '12px', fontWeight: '700', fontSize: '0.85rem'\r\n                                        }}>\r\n                                            {stats.outStock}\r\n                                        </span>\r\n                                    ) : <span style={{ opacity: 0.3 }}>-</span>}\r\n                                </td>\r\n                                <td style={{ ...tdStyle, textAlign: 'right' }}>\r\n                                    {canDelete ? (\r\n                                        <button\r\n                                            onClick={() => onDelete(size._id)}\r\n                                            style={{\r\n                                                background: 'transparent', border: 'none', cursor: 'pointer',\r\n                                                color: 'var(--text-secondary)', padding: '8px', borderRadius: '8px',\r\n                                                transition: 'all 0.2s'\r\n                                            }}\r\n                                            className=\"hover-danger\"\r\n                                            title=\"Delete Size\"\r\n                                        >\r\n                                            <IconTrash />\r\n                                        </button>\r\n                                    ) : (\r\n                                        <span style={{ fontSize: '0.75rem', fontWeight: '600', color: 'var(--text-secondary)', opacity: 0.5, cursor: 'not-allowed' }} title=\"Cannot delete: Size is in use\">\r\n                                            LOCKED\r\n                                        </span>\r\n                                    )}\r\n                                </td>\r\n                            </tr>\r\n                        );\r\n                    })}\r\n                </tbody>\r\n            </table>\r\n            <style>{`\r\n                .hover-danger:hover { background: var(--error-bg) !important; color: var(--error-color) !important; }\r\n            `}</style>\r\n        </div>\r\n    );\r\n});\r\n\r\nconst Configuration = () => {\r\n    const { apiUrl } = useConfig();\r\n    const [sizes, setSizes] = useState([]);\r\n    const [newSize, setNewSize] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [adding, setAdding] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    const fetchSizes = useCallback(async () => {\r\n        setLoading(true);\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sizes`);\r\n            const data = await res.json();\r\n            setSizes(data);\r\n        } catch (err) {\r\n            console.error(err);\r\n            setError(`Failed to load sizes.`);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [apiUrl]);\r\n\r\n    useEffect(() => {\r\n        fetchSizes();\r\n    }, [fetchSizes]);\r\n\r\n    const handleAdd = async (e) => {\r\n        e.preventDefault();\r\n        if (!newSize.trim()) return;\r\n\r\n        setAdding(true);\r\n        setError('');\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sizes/add`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ code: newSize.trim() })\r\n            });\r\n            const data = await res.json();\r\n            if (res.ok) {\r\n                setNewSize('');\r\n                fetchSizes();\r\n            } else {\r\n                setError(data.error || 'Failed to add size');\r\n            }\r\n        } catch (err) {\r\n            setError(err.message);\r\n        } finally {\r\n            setAdding(false);\r\n        }\r\n    };\r\n\r\n    const handleDelete = useCallback(async (id) => {\r\n        if (!window.confirm('Are you sure you want to delete this size?')) return;\r\n\r\n        try {\r\n            await fetch(`${apiUrl}/api/sizes/${id}`, { method: 'DELETE' });\r\n            fetchSizes();\r\n        } catch (err) {\r\n            alert('Failed to delete size');\r\n        }\r\n    }, [apiUrl, fetchSizes]);\r\n\r\n    return (\r\n        <div style={{ padding: '0', height: '100%', display: 'flex', flexDirection: 'column', background: 'var(--bg-primary)' }} className=\"animate-fade-in\">\r\n\r\n            {/* Header */}\r\n            <header style={{\r\n                padding: '1.5rem 2.5rem',\r\n                background: 'var(--bg-secondary)',\r\n                borderBottom: '1px solid var(--border-color)',\r\n                display: 'flex', justifyContent: 'space-between', alignItems: 'center'\r\n            }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1.5rem' }}>\r\n                    <div style={{\r\n                        width: '48px', height: '48px', borderRadius: '12px',\r\n                        background: 'var(--bg-tertiary)', color: 'var(--text-primary)',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                    }}>\r\n                        <IconSettings />\r\n                    </div>\r\n                    <div>\r\n                        <div style={{ color: 'var(--accent-color)', fontWeight: '700', fontSize: '0.75rem', letterSpacing: '0.1em', marginBottom: '0.2rem' }}>ADMINISTRATION</div>\r\n                        <h1 style={{ fontSize: '1.5rem', fontWeight: '800', margin: 0, letterSpacing: '-0.02em', color: 'var(--text-primary)' }}>\r\n                            System Configuration\r\n                        </h1>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <div style={{ flex: 1, padding: '2rem 2.5rem', overflowY: 'auto' }}>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'minmax(0, 1fr) 350px', gap: '2rem', height: '100%' }}>\r\n\r\n                    {/* Left Panel: Size Table */}\r\n                    <div className=\"panel\" style={{ padding: 0, overflow: 'hidden', display: 'flex', flexDirection: 'column', background: 'var(--bg-secondary)', borderRadius: '12px', border: '1px solid var(--border-color)' }}>\r\n                        <div style={{\r\n                            padding: '1.5rem', borderBottom: '1px solid var(--border-color)',\r\n                            display: 'flex', justifyContent: 'space-between', alignItems: 'center'\r\n                        }}>\r\n                            <div>\r\n                                <h3 style={{ margin: 0, fontSize: '1.1rem', color: 'var(--text-primary)' }}>Defined Article Sizes</h3>\r\n                                <p style={{ margin: '0.3rem 0 0', fontSize: '0.8rem', color: 'var(--text-secondary)' }}>\r\n                                    Configure dimensions used for barcode generation and sorting.\r\n                                </p>\r\n                            </div>\r\n                            <div style={{\r\n                                padding: '6px 12px', borderRadius: '20px', background: 'var(--bg-tertiary)',\r\n                                fontSize: '0.8rem', fontWeight: '700', color: 'var(--text-primary)'\r\n                            }}>\r\n                                {sizes.length} Sizes Active\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div style={{ flex: 1, overflowY: 'auto' }}>\r\n                            {loading ? (\r\n                                <div style={{ padding: '3rem', textAlign: 'center', color: 'var(--text-secondary)' }}>Loading configuration...</div>\r\n                            ) : (\r\n                                <SizeTable sizes={sizes} onDelete={handleDelete} />\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right Panel: Add Form */}\r\n                    <div className=\"panel\" style={{ height: 'fit-content', position: 'sticky', top: 0, background: 'var(--bg-secondary)', borderRadius: '12px', border: '1px solid var(--border-color)', overflow: 'hidden' }}>\r\n                        <div style={{ padding: '1.5rem', borderBottom: '1px solid var(--border-color)' }}>\r\n                            <h3 style={{ margin: 0, fontSize: '1.1rem', color: 'var(--text-primary)' }}>Add New Dimension</h3>\r\n                            <p style={{ margin: '0.5rem 0 0', fontSize: '0.8rem', color: 'var(--text-secondary)' }}>\r\n                                Define a new size code for inventory items.\r\n                            </p>\r\n                        </div>\r\n                        <div style={{ padding: '1.5rem' }}>\r\n                            <form onSubmit={handleAdd} style={{ display: 'flex', flexDirection: 'column', gap: '1.2rem' }}>\r\n                                <div>\r\n                                    <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em' }}>\r\n                                        Size Code\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={newSize}\r\n                                        onChange={e => setNewSize(e.target.value)}\r\n                                        placeholder=\"e.g. 90x108\"\r\n                                        style={{\r\n                                            width: '100%', padding: '0.9rem', borderRadius: '8px',\r\n                                            border: '1px solid var(--border-color)', background: 'var(--bg-primary)',\r\n                                            color: 'var(--text-primary)', fontSize: '1rem', fontWeight: '600',\r\n                                            fontFamily: 'monospace'\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n\r\n                                <div style={{ height: '0.5rem' }}></div>\r\n\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={adding || !newSize.trim()}\r\n                                    className=\"btn btn-primary\"\r\n                                    style={{\r\n                                        width: '100%', justifyContent: 'center', padding: '1rem',\r\n                                        cursor: adding || !newSize.trim() ? 'not-allowed' : 'pointer',\r\n                                        opacity: adding || !newSize.trim() ? 0.7 : 1\r\n                                    }}\r\n                                >\r\n                                    {adding ? 'Adding Configuration...' : 'Add Size Configuration'}\r\n                                </button>\r\n                            </form>\r\n\r\n                            {error && (\r\n                                <div style={{ marginTop: '1.5rem', padding: '1rem', background: 'var(--error-bg)', color: 'var(--error-color)', borderRadius: '8px', fontSize: '0.85rem', fontWeight: '600' }}>\r\n                                    ΓÜá∩╕Å {error}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                        <div style={{ padding: '1.5rem', borderTop: '1px solid var(--border-color)', background: 'var(--bg-tertiary)' }}>\r\n                            <p style={{ fontSize: '0.75rem', color: 'var(--text-secondary)', margin: 0, lineHeight: '1.5' }}>\r\n                                <strong>Tip:</strong> Size codes are unique identifiers. Once a size has associated stock data, it cannot be deleted to preserve audit integrity.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Configuration;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Dashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'updateApiUrl' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"updateApiUrl"},"fix":{"range":[3001,3015],"text":""},"desc":"Remove unused variable 'updateApiUrl'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'theme' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"theme"},"fix":{"range":[3015,3022],"text":""},"desc":"Remove unused variable 'theme'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'toggleTheme' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"toggleTheme"},"fix":{"range":[3022,3035],"text":""},"desc":"Remove unused variable 'toggleTheme'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'showSettings' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":21,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"showSettings"},"fix":{"range":[3065,3077],"text":""},"desc":"Remove unused variable 'showSettings'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setShowSettings' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":21,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"setShowSettings"},"fix":{"range":[3077,3094],"text":""},"desc":"Remove unused variable 'setShowSettings'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'tempIp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"tempIp"},"fix":{"range":[3127,3133],"text":""},"desc":"Remove unused variable 'tempIp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setTempIp' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"setTempIp"},"fix":{"range":[3133,3144],"text":""},"desc":"Remove unused variable 'setTempIp'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setActiveTab' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":32,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"setActiveTab"},"fix":{"range":[3839,3853],"text":""},"desc":"Remove unused variable 'setActiveTab'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchActiveSessions', 'fetchRecentLogs', and 'fetchStats'. Either include them or remove the dependency array.","line":132,"column":8,"nodeType":"ArrayExpression","endLine":132,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [apiUrl, activeTab, isTodayOnly, fetchStats, fetchActiveSessions, fetchRecentLogs]","fix":{"range":[8157,8189],"text":"[apiUrl, activeTab, isTodayOnly, fetchStats, fetchActiveSessions, fetchRecentLogs]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleDelete' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":140,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":140,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleDelete"},"fix":{"range":[8338,8702],"text":""},"desc":"Remove unused variable 'handleDelete'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleMarkDamaged' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":148,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":148,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleMarkDamaged"},"fix":{"range":[8710,9187],"text":""},"desc":"Remove unused variable 'handleMarkDamaged'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'totals' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":209,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":209,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"totals"},"fix":{"range":[11347,11772],"text":""},"desc":"Remove unused variable 'totals'."}]},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\n  220 |     const downloadCSV = () => {\n  221 |         if (!displayList.length) return showModal('warning', 'Export Empty', \"There is no data to export right now.\");\n> 222 |         generateAndDownloadCSV(displayList, `inventory_${activeTab}_${Date.now()}.csv`);\n      |                                                                       ^^^^^^^^^^ Cannot call impure function\n  223 |     };\n  224 |\n  225 |     const generateAndDownloadCSV = (data, filename) => {","line":222,"column":71,"nodeType":null,"endLine":222,"endColumn":81},{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":245,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":245,"endColumn":19}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useConfig } from '../context/ConfigContext';\r\nimport { io } from \"socket.io-client\";\r\n\r\n\r\n// --- Icons ---\r\nconst IconBox = () => <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z\" /><path d=\"m3.3 7 8.7 5 8.7-5\" /><path d=\"M12 22V12\" /></svg>;\r\nconst IconScan = () => <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M3 7V5a2 2 0 0 1 2-2h2\" /><path d=\"M17 3h2a2 2 0 0 1 2 2v2\" /><path d=\"M21 17v2a2 2 0 0 1-2 2h-2\" /><path d=\"M7 21H5a2 2 0 0 1-2-2v-2\" /><line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"12\" /></svg>;\r\nconst IconSettings = () => <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\" /><circle cx=\"12\" cy=\"12\" r=\"3\" /></svg>;\r\nconst IconCloud = () => <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M17.5 19a3.5 3.5 0 0 0 0-7h-1.5a7 7 0 1 0-11.91 4.9\" /><path d=\"M12 13v8\" /><path d=\"m15 18-3 3-3-3\" /></svg>;\r\n\r\nconst IconEdit = () => <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" /><path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" /></svg>;\r\nconst IconTrash = () => <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polyline points=\"3 6 5 6 21 6\" /><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" /></svg>;\r\nconst IconSignal = () => <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M2 20h.01\" /><path d=\"M7 20v-4\" /><path d=\"M12 20v-8\" /><path d=\"M17 20V8\" /><path d=\"M22 20V4\" /></svg>;\r\n\r\n\r\nconst Dashboard = () => {\r\n    const navigate = useNavigate();\r\n    const { apiUrl, updateApiUrl, theme, toggleTheme } = useConfig();\r\n    const [showSettings, setShowSettings] = useState(false);\r\n    const [tempIp, setTempIp] = useState(apiUrl);\r\n\r\n    const [stats, setStats] = useState([\r\n        { label: 'Total Inventory', value: '0', change: 'System Total', key: 'totalRolls', color: 'var(--text-secondary)', icon: '≡ƒôª' },\r\n        { label: 'Current Stock', value: '0', change: 'Live Units', key: 'stockIn', color: 'var(--success-color)', icon: '≡ƒÅ¡' },\r\n        { label: 'Dispatched', value: '0', change: 'Outbound', key: 'stockOut', color: 'var(--accent-color)', icon: '≡ƒÜ¢' },\r\n        { label: 'Missing Logs', value: '0', change: 'Action Required', key: 'missingCount', alert: true, color: 'var(--error-color)', icon: 'ΓÜá∩╕Å' }\r\n    ]);\r\n\r\n    const [recentLogs, setRecentLogs] = useState([]);\r\n    const [activeTab, setActiveTab] = useState('LIVE');\r\n\r\n    // Filters for \"Recent Logs\" only (Live view)\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [editItem, setEditItem] = useState(null);\r\n    const [isTodayOnly, setIsTodayOnly] = useState(false);\r\n    const [activeSessionCount, setActiveSessionCount] = useState(0);\r\n\r\n    // Modal State\r\n    const [modalConfig, setModalConfig] = useState({ isOpen: false, type: 'info', title: '', message: '', onConfirm: null });\r\n\r\n    const showModal = (type, title, message, onConfirm = null) => {\r\n        setModalConfig({ isOpen: true, type, title, message, onConfirm });\r\n    };\r\n\r\n    const closeModal = () => {\r\n        setModalConfig({ ...modalConfig, isOpen: false });\r\n    };\r\n\r\n    const getTodayRange = () => {\r\n        const today = new Date().toISOString().split('T')[0];\r\n        return { startDate: today, endDate: today };\r\n    };\r\n\r\n    const fetchStats = async () => {\r\n        try {\r\n            let url = `${apiUrl}/api/stats/dashboard`;\r\n            if (isTodayOnly) {\r\n                const { startDate, endDate } = getTodayRange();\r\n                url += `?startDate=${startDate}&endDate=${endDate}`;\r\n            }\r\n            const res = await fetch(url);\r\n            const data = await res.json();\r\n            setStats([\r\n                { label: 'Total Inventory', value: data.totalRolls, change: isTodayOnly ? \"Today's Total\" : 'All-time Registered', key: 'totalRolls', color: 'var(--text-secondary)', icon: '≡ƒôª' },\r\n                { label: 'Current Stock', value: data.stockIn, change: isTodayOnly ? \"Today's Inflow\" : 'Units in Warehouse', key: 'stockIn', color: 'var(--success-color)', icon: '≡ƒÅ¡' },\r\n                { label: 'Dispatched', value: data.stockOut, change: isTodayOnly ? \"Today's Outflow\" : 'Sent to Customers', key: 'stockOut', color: 'var(--accent-color)', icon: '≡ƒÜ¢' },\r\n                { label: 'Missing Logs', value: data.missingCount, change: isTodayOnly ? \"Today's Gaps\" : 'Need Resolution', key: 'missingCount', alert: data.missingCount > 0, color: 'var(--error-color)', icon: 'ΓÜá∩╕Å' }\r\n            ]);\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    const fetchRecentLogs = async () => {\r\n        try {\r\n            let url = `${apiUrl}/api/stats/list/recent?limit=50`;\r\n\r\n            if (isTodayOnly) {\r\n                const { startDate, endDate } = getTodayRange();\r\n                url += `&startDate=${startDate}&endDate=${endDate}`;\r\n            }\r\n\r\n            const res = await fetch(url);\r\n            const data = await res.json();\r\n            const normalized = data.map(item => ({\r\n                time: new Date(item.updatedAt || item.detectedAt || item.createdAt).toLocaleString(),\r\n                barcode: item.barcode,\r\n                type: item.status || 'UNKNOWN',\r\n                details: { metre: item.metre, weight: item.weight, percentage: item.percentage },\r\n                employee: item.employeeName || item.userId || 'System'\r\n            }));\r\n            setRecentLogs(normalized);\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    const fetchActiveSessions = async () => {\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sessions/active`);\r\n            const data = await res.json();\r\n            setActiveSessionCount(Array.isArray(data) ? data.length : 0);\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchStats();\r\n        fetchActiveSessions();\r\n        if (activeTab === 'LIVE') fetchRecentLogs();\r\n\r\n        const socket = io(apiUrl, {\r\n            rejectUnauthorized: false,\r\n            transports: ['websocket', 'polling']\r\n        });\r\n        socket.on('stock_update', (data) => {\r\n            if (activeTab === 'LIVE') {\r\n                const newLog = {\r\n                    time: new Date().toLocaleTimeString(),\r\n                    barcode: data.barcode,\r\n                    type: data.type,\r\n                    details: data.details,\r\n                    employee: data.user || 'System'\r\n                };\r\n                setRecentLogs(prev => [newLog, ...prev]);\r\n            }\r\n            fetchStats();\r\n        });\r\n\r\n        socket.on('session_update', () => {\r\n            fetchActiveSessions();\r\n        });\r\n\r\n        return () => socket.disconnect();\r\n    }, [apiUrl, activeTab, isTodayOnly]);\r\n\r\n\r\n    const handleCardClick = (key) => {\r\n        // Navigate to the detailed view page\r\n        navigate(`/dashboard/${key}`);\r\n    };\r\n\r\n    const handleDelete = async (barcode) => {\r\n        if (!window.confirm(\"Move this roll back to Missing items?\")) return;\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/mobile/inventory/delete/${barcode}`, { method: 'DELETE' });\r\n            if (res.ok) { fetchRecentLogs(); fetchStats(); }\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    const handleMarkDamaged = async (barcode) => {\r\n        if (!window.confirm(\"Mark this barcode as DAMAGED? It will be removed from the missing list and ignored by the system.\")) return;\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/mobile/missing/damaged/${barcode}`, { method: 'PATCH' });\r\n            if (res.ok) { fetchRecentLogs(); fetchStats(); }\r\n            else { alert(\"Operation failed.\"); }\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    const handleSaveEdit = async () => {\r\n        if (!editItem) return;\r\n        try {\r\n            const isMissingResolve = activeTab === 'missingCount'; // Not really used in LIVE view but kept for safety if we reuse logic\r\n            const endpoint = isMissingResolve ? `${apiUrl}/api/mobile/transaction` : `${apiUrl}/api/mobile/inventory/update`;\r\n            const method = isMissingResolve ? 'POST' : 'PUT';\r\n\r\n            // Standardize payloads\r\n            const payload = {\r\n                barcode: editItem.barcode,\r\n                metre: parseFloat(editItem.details.metre || 0),\r\n                weight: parseFloat(editItem.details.weight || 0),\r\n                percentage: parseFloat(editItem.details.percentage || 100),\r\n                type: editItem.type || 'IN',\r\n                status: editItem.type || 'IN'\r\n            };\r\n\r\n            if (payload.metre <= 0 || payload.weight <= 0) {\r\n                return alert(\"Metric Error: Metre and Weight must be positive numbers.\");\r\n            }\r\n\r\n            const res = await fetch(endpoint, {\r\n                method: method,\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(payload)\r\n            });\r\n\r\n            const result = await res.json();\r\n            if (res.ok) {\r\n                setEditItem(null);\r\n                fetchRecentLogs();\r\n                fetchStats();\r\n            } else {\r\n                alert(result.error || \"System rejected transaction. Verify data format.\");\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert(\"Network link failed. Verify server connectivity.\");\r\n        }\r\n    };\r\n\r\n    const displayList = (() => {\r\n        // Only showing recent logs on dashboard now\r\n        const rawList = recentLogs;\r\n        if (!Array.isArray(rawList)) return [];\r\n        return rawList.filter(log => {\r\n            const term = searchTerm.toLowerCase();\r\n            return log.barcode.toLowerCase().includes(term) || (log.type && log.type.toLowerCase().includes(term));\r\n        });\r\n    })();\r\n\r\n    // Totals for the *visible* list (Recent Logs)\r\n    const totals = React.useMemo(() => {\r\n        if (!displayList.length) return { metre: 0, weight: 0 };\r\n        return displayList.reduce((acc, item) => {\r\n            if (item.details) {\r\n                acc.metre += parseFloat(item.details.metre || 0);\r\n                acc.weight += parseFloat(item.details.weight || 0);\r\n            }\r\n            return acc;\r\n        }, { metre: 0, weight: 0 });\r\n    }, [displayList]);\r\n\r\n    const downloadCSV = () => {\r\n        if (!displayList.length) return showModal('warning', 'Export Empty', \"There is no data to export right now.\");\r\n        generateAndDownloadCSV(displayList, `inventory_${activeTab}_${Date.now()}.csv`);\r\n    };\r\n\r\n    const generateAndDownloadCSV = (data, filename) => {\r\n        try {\r\n            const headers = [\"Timestamp\", \"Barcode\", \"Status\", \"Metre\", \"Weight\", \"Quality %\"];\r\n            const rows = data.map(item => [\r\n                `\"${item.time}\"`,\r\n                item.barcode,\r\n                item.type,\r\n                item.details?.metre || 0,\r\n                item.details?.weight || 0,\r\n                item.details?.percentage || 0\r\n            ]);\r\n            const csvContent = \"data:text/csv;charset=utf-8,\"\r\n                + [headers.join(','), ...rows.map(e => e.join(','))].join('\\n');\r\n            const encodedUri = encodeURI(csvContent);\r\n            const link = document.createElement(\"a\");\r\n            link.setAttribute(\"href\", encodedUri);\r\n            link.setAttribute(\"download\", filename);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n        } catch (e) {\r\n            showModal('error', 'Export Failed', 'An error occurred while generating the CSV file.');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ display: 'flex', flexDirection: 'column', height: '100%', overflow: 'hidden' }}>\r\n\r\n            {/* Header (Drag area) */}\r\n            <header style={{\r\n                padding: '1rem 2.5rem',\r\n                background: 'var(--bg-secondary)',\r\n                borderBottom: '1px solid var(--border-color)',\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                zIndex: 5\r\n            }} className=\"app-region-drag\">\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1.5rem' }} className=\"app-region-no-drag\">\r\n                    <div>\r\n                        <h1 style={{ fontSize: '1.4rem', fontWeight: '800', margin: 0, letterSpacing: '-0.02em' }}>\r\n                            Operations Dashboard\r\n                        </h1>\r\n                        <p style={{ fontSize: '0.75rem', fontWeight: '600', opacity: 0.6 }}>SYSTEM OPERATIONAL ΓÇó {new Date().toDateString().toUpperCase()}</p>\r\n                    </div>\r\n                    <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                        <button\r\n                            onClick={() => setIsTodayOnly(!isTodayOnly)}\r\n                            style={{\r\n                                background: 'transparent',\r\n                                color: isTodayOnly ? 'var(--accent-color)' : 'var(--text-secondary)',\r\n                                border: isTodayOnly ? '2px solid var(--accent-color)' : '1px solid var(--border-color)',\r\n                                padding: '0.4rem 1.2rem',\r\n                                borderRadius: '6px',\r\n                                fontSize: '0.75rem',\r\n                                fontFamily: '\"Segoe UI\", sans-serif',\r\n                                fontWeight: '600',\r\n                                cursor: 'pointer',\r\n                                transition: 'all 0.2s',\r\n                                letterSpacing: '0.02em',\r\n                                display: 'flex',\r\n                                alignItems: 'center',\r\n                                gap: '0.5rem'\r\n                            }}\r\n                        >\r\n                            <span style={{ fontSize: '1rem' }}>{isTodayOnly ? 'ΓùÅ' : 'Γùï'}</span>\r\n                            {isTodayOnly ? 'Today\\'s View' : 'All History'}\r\n                        </button>\r\n                        <button\r\n                            onClick={downloadCSV}\r\n                            style={{\r\n                                background: 'transparent',\r\n                                color: 'var(--text-primary)',\r\n                                border: '1px solid var(--border-color)',\r\n                                padding: '0.4rem 1.2rem',\r\n                                borderRadius: '6px',\r\n                                fontSize: '0.75rem',\r\n                                fontFamily: '\"Segoe UI\", sans-serif',\r\n                                fontWeight: '600',\r\n                                cursor: 'pointer',\r\n                                transition: 'all 0.2s',\r\n                                letterSpacing: '0.02em',\r\n                                display: 'flex',\r\n                                alignItems: 'center',\r\n                                gap: '0.5rem'\r\n                            }}\r\n                        >\r\n                            <span style={{ opacity: 0.7 }}>≡ƒôÑ</span> Export Log\r\n                        </button>\r\n\r\n                        <div style={{ width: '1px', height: '20px', background: 'var(--border-color)', margin: '0 0.5rem' }}></div>\r\n\r\n                        <button\r\n                            onClick={() => navigate('/sessions')}\r\n                            style={{\r\n                                padding: '0.4rem 1.2rem',\r\n                                background: activeSessionCount > 0 ? 'var(--accent-bg)' : 'var(--bg-primary)',\r\n                                border: activeSessionCount > 0 ? '1px solid var(--accent-color)' : '1px solid var(--border-color)',\r\n                                borderRadius: '6px',\r\n                                fontSize: '0.75rem',\r\n                                fontWeight: '700',\r\n                                color: activeSessionCount > 0 ? 'var(--accent-color)' : 'var(--text-secondary)',\r\n                                display: 'flex',\r\n                                alignItems: 'center',\r\n                                gap: '0.5rem',\r\n                                cursor: 'pointer',\r\n                                transition: 'all 0.2s'\r\n                            }}\r\n                        >\r\n                            <IconSignal />\r\n                            {activeSessionCount > 0 ? `${activeSessionCount} ACTIVE SESSIONS` : 'NO ACTIVE SESSIONS'}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"app-region-no-drag\" style={{ display: 'flex', gap: '1rem', alignItems: 'center' }}>\r\n                    <div style={{ position: 'relative' }}>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search recent logs...\"\r\n                            value={searchTerm}\r\n                            onChange={e => setSearchTerm(e.target.value)}\r\n                            style={{\r\n                                width: '320px',\r\n                                background: 'var(--bg-primary)',\r\n                                paddingLeft: '2.8rem',\r\n                                borderRadius: '10px',\r\n                                border: '1px solid var(--border-color)',\r\n                                height: '42px'\r\n                            }}\r\n                        />\r\n                        <span style={{ position: 'absolute', left: '1.1rem', top: '50%', transform: 'translateY(-50%)', fontSize: '1.1rem' }}>≡ƒöì</span>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Page View with Padded Inset */}\r\n            <div style={{ flex: 1, padding: '2rem 2.5rem', overflowY: 'auto' }} className=\"animate-fade-in native-scroll\">\r\n\r\n                {/* Industrial Metrics Grid */}\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '1.5rem', marginBottom: '2.5rem' }}>\r\n                    {stats.map((stat, i) => (\r\n                        <div\r\n                            key={i}\r\n                            className=\"panel glass\"\r\n                            onClick={() => handleCardClick(stat.key)}\r\n                            title=\"Click for Detailed Report\"\r\n                            style={{\r\n                                cursor: 'pointer',\r\n                                borderTop: `4px solid ${stat.color}`,\r\n                                transition: 'all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)',\r\n                                padding: '1.8rem',\r\n                                position: 'relative'\r\n                            }}\r\n                            onMouseOver={e => e.currentTarget.style.transform = 'translateY(-4px)'}\r\n                            onMouseOut={e => e.currentTarget.style.transform = 'translateY(0)'}\r\n                        >\r\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                                <div>\r\n                                    <span style={{ fontSize: '1rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em' }}>{stat.label}</span>\r\n                                    <div style={{ fontSize: '3rem', fontWeight: '800', margin: '0.75rem 0', letterSpacing: '-0.03em' }}>{stat.value}</div>\r\n                                </div>\r\n                                <div style={{ fontSize: '1.5rem', opacity: 0.8 }}>{stat.icon}</div>\r\n                            </div>\r\n                            <div style={{ fontSize: '0.85rem', color: 'var(--text-secondary)', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n                                <span style={{ width: '8px', height: '8px', borderRadius: '50%', background: stat.color }}></span>\r\n                                {stat.change}\r\n                            </div>\r\n                            <div style={{ position: 'absolute', top: '10px', right: '10px', opacity: 0, transition: 'opacity 0.2s', fontSize: '0.7rem' }} className=\"hover-hint\">\r\n                                View Details Γåù\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                <style>{`\r\n                    .panel:hover .hover-hint { opacity: 0.6 !important; }\r\n                `}</style>\r\n\r\n                {/* Content Table Area */}\r\n                <div className=\"panel\" style={{ background: 'var(--bg-secondary)', padding: 0 }}>\r\n                    <div style={{ padding: '1.5rem 2rem', borderBottom: '1px solid var(--border-color)', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '1.5rem' }}>\r\n                            <h2 style={{ fontSize: '1.1rem', margin: 0 }}>\r\n                                Real-time Operations Log\r\n                            </h2>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style={{ width: '100%', overflowX: 'auto' }}>\r\n                        <table style={{ width: '100%', borderCollapse: 'collapse', minWidth: '1000px' }}>\r\n                            <thead style={{ position: 'sticky', top: 0, zIndex: 1, background: 'var(--table-header-bg)' }}>\r\n                                <tr>\r\n                                    <th style={thStyle}>TIMESTAMPS</th>\r\n                                    <th style={thStyle}>BARCODE ID</th>\r\n                                    <th style={thStyle}>FLOW STATUS</th>\r\n                                    <th style={thStyle}>METRICS (M/KG)</th>\r\n                                    <th style={thStyle}>OPERATOR</th>\r\n                                    <th style={{ ...thStyle, textAlign: 'right' }}>CONTROL</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {displayList.length === 0 ? (\r\n                                    <tr><td colSpan=\"6\" style={{ padding: '4rem', textAlign: 'center', color: 'var(--text-secondary)' }}>No transactions recorded in this period.</td></tr>\r\n                                ) : displayList.map((log, i) => {\r\n                                    return (\r\n                                        <tr key={i} style={{ borderBottom: '1px solid var(--border-color)', background: i % 2 === 0 ? 'var(--row-alt-bg)' : 'transparent' }}>\r\n                                            <td style={tdStyle}><span style={{ opacity: 0.8, fontWeight: '500' }}>{log.time}</span></td>\r\n                                            <td style={{ ...tdStyle, fontSize: '1.25rem', fontWeight: '800', color: 'var(--accent-color)', fontFamily: 'monospace' }}>{log.barcode}</td>\r\n                                            <td style={tdStyle}>\r\n                                                <StatusBadge type={log.type} />\r\n                                            </td>\r\n                                            <td style={tdStyle}>\r\n                                                {log.details?.metre ? (\r\n                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                                                        <Metric label=\"M\" value={log.details.metre} />\r\n                                                        <Metric label=\"KG\" value={log.details.weight} />\r\n                                                        <Metric label=\"Q\" value={Number(log.details.percentage).toFixed(2) + '%'} color={Number(log.details.percentage) < 80 ? 'var(--warning-color)' : 'var(--text-secondary)'} />\r\n                                                    </div>\r\n                                                ) : <span style={{ opacity: 0.4 }}>PENDING REGISTRATION</span>}\r\n                                            </td>\r\n                                            <td style={tdStyle}>\r\n                                                <span style={{ fontSize: '0.9rem', fontWeight: '600', color: 'var(--text-primary)', opacity: 0.9 }}>\r\n                                                    {log.employee || <span style={{ opacity: 0.4, fontStyle: 'italic' }}>System</span>}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td style={{ ...tdStyle, textAlign: 'right' }}>\r\n                                                <button\r\n                                                    onClick={() => {\r\n                                                        const isInvalidType = log.type === 'MISSING' || log.type === 'PENDING' || !log.type;\r\n                                                        setEditItem({\r\n                                                            ...log,\r\n                                                            type: isInvalidType ? 'IN' : (log.type === 'OUT' ? 'OUT' : 'IN'),\r\n                                                            details: {\r\n                                                                metre: log.details.metre || '',\r\n                                                                weight: log.details.weight || '',\r\n                                                                percentage: log.details.percentage || '100'\r\n                                                            }\r\n                                                        });\r\n                                                    }}\r\n                                                    className=\"btn\"\r\n                                                    title=\"Edit\"\r\n                                                    style={{\r\n                                                        padding: '8px',\r\n                                                        fontSize: '11px',\r\n                                                        background: 'var(--bg-tertiary)',\r\n                                                        color: 'inherit',\r\n                                                        border: 'none',\r\n                                                        fontWeight: '800',\r\n                                                        borderRadius: '8px',\r\n                                                        minWidth: '36px',\r\n                                                        display: 'inline-flex',\r\n                                                        alignItems: 'center',\r\n                                                        justifyContent: 'center'\r\n                                                    }}\r\n                                                >\r\n                                                    <IconEdit />\r\n                                                </button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    );\r\n                                })}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {/* Edit Modal */}\r\n            {\r\n                editItem && (\r\n                    <div style={modalOverlayStyle}>\r\n                        <div className=\"panel animate-fade-in\" style={{ width: '400px', boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5)' }}>\r\n                            <h3 style={{ marginBottom: '1rem' }}>Adjust Roll Parameters</h3>\r\n                            <p style={{ fontSize: '0.8rem', color: 'var(--accent-color)', marginBottom: '1.5rem', fontWeight: '700' }}>ROLL ID: {editItem.barcode}</p>\r\n\r\n                            <div style={{ display: 'grid', gap: '1.25rem' }}>\r\n                                <div>\r\n                                    <label style={labelStyle}>Length (Metres)</label>\r\n                                    <input type=\"number\" value={editItem.details.metre} onChange={e => setEditItem({ ...editItem, details: { ...editItem.details, metre: e.target.value } })} style={{ width: '100%' }} />\r\n                                </div>\r\n                                <div>\r\n                                    <label style={labelStyle}>Weight (Kilograms)</label>\r\n                                    <input type=\"number\" value={editItem.details.weight} onChange={e => setEditItem({ ...editItem, details: { ...editItem.details, weight: e.target.value } })} style={{ width: '100%' }} />\r\n                                </div>\r\n                                <div>\r\n                                    <label style={labelStyle}>Quality Index (%)</label>\r\n                                    <input type=\"number\" value={editItem.details.percentage} onChange={e => setEditItem({ ...editItem, details: { ...editItem.details, percentage: e.target.value } })} style={{ width: '100%' }} />\r\n                                </div>\r\n                                <div>\r\n                                    <label style={labelStyle}>Flow Status</label>\r\n                                    <select\r\n                                        value={editItem.type}\r\n                                        onChange={e => setEditItem({ ...editItem, type: e.target.value })}\r\n                                        style={{ width: '100%', padding: '0.8rem', background: 'var(--bg-primary)', color: 'var(--text-primary)', border: '1px solid var(--border-color)', borderRadius: '8px' }}\r\n                                    >\r\n                                        <option value=\"IN\">STOCK-IN</option>\r\n                                        <option value=\"OUT\">DISPATCH (OUT)</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div style={{ display: 'flex', gap: '1rem', marginTop: '2rem' }}>\r\n                                <button onClick={handleSaveEdit} className=\"btn btn-primary\" style={{ flex: 1 }}>SAVE CHANGES</button>\r\n                                <button onClick={() => setEditItem(null)} className=\"btn btn-secondary\" style={{ flex: 1 }}>DISCARD</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n            {/* Custom Confirmation Modal */}\r\n            {modalConfig.isOpen && (\r\n                <div style={modalOverlayStyle}>\r\n                    <div className=\"panel animate-fade-in\" style={{ width: '400px', borderTop: `4px solid ${modalConfig.type === 'error' ? 'var(--error-color)' : (modalConfig.type === 'success' ? 'var(--success-color)' : 'var(--accent-color)')}` }}>\r\n                        <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\r\n                                <div style={{\r\n                                    fontSize: '1.5rem',\r\n                                    color: modalConfig.type === 'error' ? 'var(--error-color)' : (modalConfig.type === 'success' ? 'var(--success-color)' : 'var(--accent-color)')\r\n                                }}>\r\n                                    {modalConfig.type === 'error' ? 'ΓÜá∩╕Å' : (modalConfig.type === 'success' ? 'Γ£à' : 'Γä╣∩╕Å')}\r\n                                </div>\r\n                                <h3 style={{ margin: 0, fontSize: '1.2rem', fontWeight: '700' }}>{modalConfig.title}</h3>\r\n                            </div>\r\n                            <p style={{ fontSize: '0.9rem', color: 'var(--text-secondary)', lineHeight: '1.5', margin: 0 }}>\r\n                                {modalConfig.message}\r\n                            </p>\r\n                            <div style={{ display: 'flex', gap: '0.75rem', marginTop: '1rem', justifyContent: 'flex-end' }}>\r\n                                {modalConfig.type === 'confirm' ? (\r\n                                    <>\r\n                                        <button onClick={closeModal} className=\"btn btn-secondary\">Cancel</button>\r\n                                        <button onClick={() => { modalConfig.onConfirm(); closeModal(); }} className=\"btn btn-primary\">Confirm</button>\r\n                                    </>\r\n                                ) : (\r\n                                    <button onClick={closeModal} className=\"btn btn-secondary\" style={{ width: '100%' }}>Close</button>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div >\r\n    );\r\n};\r\n\r\n\r\n// --- Sub-components ---\r\n\r\nconst StatusBadge = ({ type }) => {\r\n    const isSuccess = type === 'IN' || type === 'RESOLVED';\r\n    const isOut = type === 'OUT';\r\n    return (\r\n        <span style={{\r\n            padding: '4px 10px', borderRadius: '6px', fontSize: '11px', fontWeight: '700',\r\n            background: isSuccess ? 'var(--success-bg)' : (isOut ? 'rgba(99, 102, 241, 0.1)' : 'var(--error-bg)'),\r\n            color: isSuccess ? 'var(--success-color)' : (isOut ? 'var(--accent-color)' : 'var(--error-color)'),\r\n            border: `1px solid ${isSuccess ? 'rgba(16, 185, 129, 0.2)' : 'transparent'}`\r\n        }}>\r\n            {type === 'IN' ? 'STOCK-IN' : (type === 'OUT' ? 'DISPATCH' : type)}\r\n        </span>\r\n    );\r\n};\r\n\r\nconst Metric = ({ label, value, color }) => (\r\n    <div style={{ display: 'flex', alignItems: 'flex-start', flexDirection: 'column', gap: '2px', background: 'var(--bg-primary)', padding: '0.4rem 0.6rem', borderRadius: '8px', border: '1px solid var(--border-color)', minWidth: '70px' }}>\r\n        <span style={{ fontSize: '0.7rem', fontWeight: '800', opacity: 0.5, letterSpacing: '0.05em' }}>{label}</span>\r\n        <span style={{ fontSize: '1.2rem', fontWeight: '800', color: color || 'inherit', fontFamily: 'monospace' }}>{value}</span>\r\n    </div>\r\n);\r\n\r\n// --- Styles ---\r\nconst thStyle = { padding: '1rem 1rem', textAlign: 'left', fontSize: '0.8rem', fontWeight: '800', letterSpacing: '0.05em', color: 'var(--text-secondary)', textTransform: 'uppercase' };\r\nconst tdStyle = { padding: '0.8rem 1rem', fontSize: '1rem', fontWeight: '500' };\r\nconst modalOverlayStyle = { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'var(--modal-overlay)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 };\r\nconst labelStyle = { display: 'block', marginBottom: '0.4rem', fontSize: '0.75rem', fontWeight: '700', textTransform: 'uppercase', letterSpacing: '0.05em', opacity: 0.6 };\r\n\r\nexport default Dashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\DetailedStats.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Employees.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchEmployees'. Either include it or remove the dependency array.","line":21,"column":8,"nodeType":"ArrayExpression","endLine":21,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchEmployees]","fix":{"range":[844,846],"text":"[fetchEmployees]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":79,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useConfig } from '../context/ConfigContext';\r\nimport { IconUsers, IconTrash, IconEye, IconEyeOff, IconEdit } from '../components/Icons';\r\n\r\nconst Employees = () => {\r\n    const { apiUrl } = useConfig();\r\n    const [employees, setEmployees] = useState([]);\r\n    const [newName, setNewName] = useState('');\r\n    const [newPin, setNewPin] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [adding, setAdding] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    // State for PIN visibility and editing\r\n    const [visiblePins, setVisiblePins] = useState({});\r\n    const [editingPinId, setEditingPinId] = useState(null);\r\n    const [editPinValue, setEditPinValue] = useState('');\r\n\r\n    useEffect(() => {\r\n        fetchEmployees();\r\n    }, []);\r\n\r\n    const fetchEmployees = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/employees`);\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setEmployees(data);\r\n            } else {\r\n                setError('Failed to load employees');\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n            setError('Network error');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleAdd = async (e) => {\r\n        e.preventDefault();\r\n        if (!newName.trim() || !newPin.trim()) return;\r\n\r\n        setAdding(true);\r\n        setError('');\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/employees/add`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ name: newName.trim(), pin: newPin.trim() })\r\n            });\r\n\r\n            if (res.ok) {\r\n                setNewName('');\r\n                setNewPin('');\r\n                fetchEmployees();\r\n            } else {\r\n                const data = await res.json();\r\n                setError(data.error || 'Failed to add employee');\r\n            }\r\n        } catch (err) {\r\n            setError(err.message);\r\n        } finally {\r\n            setAdding(false);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id, name) => {\r\n        if (!window.confirm(`Are you sure you want to TERMINATE ${name}? Their access will be revoked but history preserved.`)) return;\r\n\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/employees/${id}`, { method: 'DELETE' });\r\n            if (res.ok) {\r\n                fetchEmployees();\r\n            } else {\r\n                alert('Failed to terminate');\r\n            }\r\n        } catch (err) {\r\n            alert('Failed to terminate employee');\r\n        }\r\n    };\r\n\r\n    const togglePinVisibility = (id) => {\r\n        setVisiblePins(prev => ({ ...prev, [id]: !prev[id] }));\r\n    };\r\n\r\n    const startEditPin = (emp) => {\r\n        setEditingPinId(emp._id);\r\n        setEditPinValue('');\r\n    };\r\n\r\n    const saveNewPin = async (id) => {\r\n        if (!editPinValue || editPinValue.length < 4) {\r\n            alert('PIN must be at least 4 digits');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/employees/update-pin/${id}`, {\r\n                method: 'PUT',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ pin: editPinValue })\r\n            });\r\n\r\n            if (res.ok) {\r\n                setEditingPinId(null);\r\n                setEditPinValue('');\r\n                fetchEmployees(); // Refresh to ensure data consistency\r\n                alert('PIN Updated Successfully');\r\n            } else {\r\n                const data = await res.json();\r\n                alert(data.error || 'Failed to update PIN');\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert('Network Error');\r\n        }\r\n    };\r\n\r\n    const thStyle = {\r\n        padding: '1rem 1.5rem', textAlign: 'left', fontWeight: '800', fontSize: '0.75rem',\r\n        color: 'var(--text-secondary)', letterSpacing: '0.05em', textTransform: 'uppercase'\r\n    };\r\n    const tdStyle = {\r\n        padding: '1rem 1.5rem', borderBottom: '1px solid var(--border-color)', verticalAlign: 'middle'\r\n    };\r\n    const labelStyle = {\r\n        display: 'block', marginBottom: '0.5rem', fontSize: '0.75rem', fontWeight: '700',\r\n        color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em'\r\n    };\r\n    const inputStyle = {\r\n        width: '100%', padding: '0.9rem', borderRadius: '8px',\r\n        border: '1px solid var(--border-color)', background: 'var(--bg-primary)',\r\n        color: 'var(--text-primary)', fontSize: '0.95rem', fontWeight: '500'\r\n    };\r\n\r\n\r\n    return (\r\n        <div style={{ padding: '0', height: '100%', display: 'flex', flexDirection: 'column', background: 'var(--bg-primary)' }} className=\"animate-fade-in\">\r\n            {/* Header */}\r\n            <header style={{\r\n                padding: '1.5rem 2.5rem',\r\n                background: 'var(--bg-secondary)',\r\n                borderBottom: '1px solid var(--border-color)',\r\n                display: 'flex', justifyContent: 'space-between', alignItems: 'center'\r\n            }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1.5rem' }}>\r\n                    <div style={{\r\n                        width: '48px', height: '48px', borderRadius: '12px',\r\n                        background: 'var(--bg-tertiary)', color: 'var(--text-primary)',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                    }}>\r\n                        <IconUsers />\r\n                    </div>\r\n                    <div>\r\n                        <div style={{ color: 'var(--accent-color)', fontWeight: '700', fontSize: '0.75rem', letterSpacing: '0.1em', marginBottom: '0.2rem' }}>ADMINISTRATION</div>\r\n                        <h1 style={{ fontSize: '1.5rem', fontWeight: '800', margin: 0, letterSpacing: '-0.02em', color: 'var(--text-primary)' }}>\r\n                            Employee Management\r\n                        </h1>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <div style={{ flex: 1, padding: '2rem 2.5rem', overflowY: 'auto' }}>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'minmax(0, 1fr) 350px', gap: '2rem', height: '100%' }}>\r\n\r\n                    {/* Left: Employee List */}\r\n                    <div className=\"panel\" style={{ padding: 0, overflow: 'hidden', display: 'flex', flexDirection: 'column', background: 'var(--bg-secondary)', borderRadius: '12px', border: '1px solid var(--border-color)' }}>\r\n                        <div style={{ padding: '1.5rem', borderBottom: '1px solid var(--border-color)', background: 'var(--bg-secondary)', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                            <h3 style={{ margin: 0, fontSize: '1.1rem', color: 'var(--text-primary)' }}>Staff Roster</h3>\r\n                            <span style={{ fontSize: '0.8rem', fontWeight: '600', color: 'var(--text-secondary)' }}>{employees.length} Registered</span>\r\n                        </div>\r\n\r\n                        <div style={{ flex: 1, overflowY: 'auto' }}>\r\n                            <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>\r\n                                <thead style={{ position: 'sticky', top: 0, background: 'var(--bg-secondary)', zIndex: 10 }}>\r\n                                    <tr style={{ borderBottom: '1px solid var(--border-color)', textAlign: 'left' }}>\r\n                                        <th style={thStyle}>ID</th>\r\n                                        <th style={thStyle}>NAME</th>\r\n                                        <th style={thStyle}>ACCESS PIN</th>\r\n                                        <th style={thStyle}>LAST ACTIVE</th>\r\n                                        <th style={thStyle}>LAST DEVICE</th>\r\n                                        <th style={thStyle}>STATUS</th>\r\n                                        <th style={{ ...thStyle, textAlign: 'right' }}>ACTIONS</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {loading ? (\r\n                                        <tr><td colSpan=\"7\" style={{ padding: '3rem', textAlign: 'center' }}>Loading...</td></tr>\r\n                                    ) : employees.length === 0 ? (\r\n                                        <tr><td colSpan=\"7\" style={{ padding: '3rem', textAlign: 'center', color: 'var(--text-secondary)' }}>No employees found.</td></tr>\r\n                                    ) : employees.map((emp, i) => (\r\n                                        <tr key={emp._id} style={{\r\n                                            borderBottom: '1px solid var(--border-color)',\r\n                                            background: i % 2 === 0 ? 'transparent' : 'rgba(0,0,0,0.02)',\r\n                                            opacity: emp.status === 'TERMINATED' ? 0.6 : 1\r\n                                        }}>\r\n                                            <td style={{ ...tdStyle, fontFamily: 'monospace', fontWeight: '700', color: 'var(--accent-color)' }}>{emp.employeeId || '-'}</td>\r\n                                            <td style={{ ...tdStyle, fontWeight: '600', color: 'var(--text-primary)' }}>{emp.name}</td>\r\n                                            <td style={tdStyle}>\r\n                                                {editingPinId === emp._id ? (\r\n                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                                                        <input\r\n                                                            autoFocus\r\n                                                            type=\"text\"\r\n                                                            maxLength={6}\r\n                                                            value={editPinValue}\r\n                                                            onChange={e => setEditPinValue(e.target.value.replace(/\\D/g, ''))}\r\n                                                            placeholder=\"PIN\"\r\n                                                            style={{ width: '60px', padding: '4px', borderRadius: '4px', border: '1px solid var(--accent-color)', background: 'var(--bg-primary)', color: 'var(--text-primary)', outline: 'none' }}\r\n                                                        />\r\n                                                        <button onClick={() => saveNewPin(emp._id)} style={{ background: 'var(--success-color)', border: 'none', borderRadius: '4px', color: 'white', cursor: 'pointer', padding: '0 6px', fontSize: '0.7rem', fontWeight: 'bold' }}>Γ£ô</button>\r\n                                                        <button onClick={() => setEditingPinId(null)} style={{ background: 'var(--bg-tertiary)', border: '1px solid var(--border-color)', borderRadius: '4px', color: 'var(--text-primary)', cursor: 'pointer', padding: '0 6px', fontSize: '0.7rem' }}>Γ£ò</button>\r\n                                                    </div>\r\n                                                ) : (\r\n                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.8rem' }}>\r\n                                                        <span style={{ fontFamily: 'monospace', fontSize: '1rem', letterSpacing: '2px', minWidth: '40px', color: 'var(--text-primary)' }}>\r\n                                                            {visiblePins[emp._id] ? emp.pin : 'ΓÇóΓÇóΓÇóΓÇó'}\r\n                                                        </span>\r\n                                                        <div style={{ display: 'flex', gap: '4px', opacity: 0.5 }}>\r\n                                                            <button\r\n                                                                onClick={() => togglePinVisibility(emp._id)}\r\n                                                                style={{ background: 'transparent', border: 'none', color: 'var(--text-primary)', cursor: 'pointer', padding: 0 }}\r\n                                                            >\r\n                                                                {visiblePins[emp._id] ? <IconEyeOff /> : <IconEye />}\r\n                                                            </button>\r\n                                                            {emp.status === 'ACTIVE' && (\r\n                                                                <button\r\n                                                                    onClick={() => startEditPin(emp)}\r\n                                                                    style={{ background: 'transparent', border: 'none', color: 'var(--text-primary)', cursor: 'pointer', padding: 0 }}\r\n                                                                >\r\n                                                                    <IconEdit />\r\n                                                                </button>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                )}\r\n                                            </td>\r\n                                            <td style={{ ...tdStyle, fontSize: '0.8rem', color: 'var(--text-secondary)' }}>\r\n                                                {emp.lastActive ? new Date(emp.lastActive).toLocaleString() : <span style={{ opacity: 0.4 }}>Never</span>}\r\n                                            </td>\r\n                                            <td style={tdStyle}>\r\n                                                {emp.lastScanner ? (\r\n                                                    <span style={{\r\n                                                        background: 'var(--bg-tertiary)', padding: '4px 8px', borderRadius: '4px',\r\n                                                        fontSize: '0.75rem', fontWeight: '600', color: 'var(--text-primary)', border: '1px solid var(--border-color)'\r\n                                                    }}>\r\n                                                        ≡ƒô▒ {emp.lastScanner}\r\n                                                    </span>\r\n                                                ) : <span style={{ opacity: 0.4, fontSize: '0.8rem' }}>-</span>}\r\n                                            </td>\r\n                                            <td style={tdStyle}>\r\n                                                <span style={{\r\n                                                    padding: '4px 10px', borderRadius: '20px', fontSize: '0.7rem', fontWeight: '800',\r\n                                                    background: emp.status === 'ACTIVE' ? 'var(--success-bg)' : 'var(--error-bg)',\r\n                                                    color: emp.status === 'ACTIVE' ? 'var(--success-color)' : 'var(--error-color)',\r\n                                                    letterSpacing: '0.05em'\r\n                                                }}>\r\n                                                    {emp.status}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td style={{ ...tdStyle, textAlign: 'right' }}>\r\n                                                {emp.status === 'ACTIVE' && (\r\n                                                    <button\r\n                                                        onClick={() => handleDelete(emp._id, emp.name)}\r\n                                                        className=\"btn-icon-danger\"\r\n                                                        title=\"Terminate Access\"\r\n                                                    >\r\n                                                        <IconTrash />\r\n                                                    </button>\r\n                                                )}\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: Add Form */}\r\n                    <div className=\"panel\" style={{ height: 'fit-content', position: 'sticky', top: 0, background: 'var(--bg-secondary)', borderRadius: '12px', border: '1px solid var(--border-color)', overflow: 'hidden' }}>\r\n                        <div style={{ padding: '1.5rem', borderBottom: '1px solid var(--border-color)' }}>\r\n                            <h3 style={{ margin: 0, fontSize: '1.1rem', color: 'var(--text-primary)' }}>Register New Staff</h3>\r\n                            <p style={{ margin: '0.5rem 0 0', fontSize: '0.8rem', color: 'var(--text-secondary)' }}>\r\n                                Create access credentials for floor staff.\r\n                            </p>\r\n                        </div>\r\n                        <div style={{ padding: '1.5rem' }}>\r\n                            <form onSubmit={handleAdd} style={{ display: 'flex', flexDirection: 'column', gap: '1.2rem' }}>\r\n                                <div>\r\n                                    <label style={labelStyle}>Employee Name</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={newName}\r\n                                        onChange={e => setNewName(e.target.value)}\r\n                                        placeholder=\"e.g. Michael Scott\"\r\n                                        style={inputStyle}\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label style={labelStyle}>Access PIN (4-6 Digits)</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={newPin}\r\n                                        onChange={e => setNewPin(e.target.value.replace(/\\D/g, ''))}\r\n                                        placeholder=\"e.g. 1985\"\r\n                                        maxLength={6}\r\n                                        style={{ ...inputStyle, fontFamily: 'monospace', letterSpacing: '2px', fontSize: '1.1rem' }}\r\n                                    />\r\n                                </div>\r\n\r\n                                <div style={{ height: '1rem' }}></div>\r\n\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={adding || !newName.trim() || !newPin.trim()}\r\n                                    className=\"btn btn-primary\"\r\n                                    style={{ width: '100%', justifyContent: 'center', padding: '1rem', cursor: adding ? 'not-allowed' : 'pointer' }}\r\n                                >\r\n                                    {adding ? 'Creating Profile...' : 'Create Employee Profile'}\r\n                                </button>\r\n                            </form>\r\n\r\n                            {error && (\r\n                                <div style={{ marginTop: '1.5rem', padding: '1rem', background: 'var(--error-bg)', color: 'var(--error-color)', borderRadius: '8px', fontSize: '0.85rem', fontWeight: '600' }}>\r\n                                    ΓÜá∩╕Å {error}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                        <div style={{ padding: '1.5rem', borderTop: '1px solid var(--border-color)', background: 'var(--bg-tertiary)' }}>\r\n                            <p style={{ fontSize: '0.75rem', color: 'var(--text-secondary)', margin: 0, lineHeight: '1.5' }}>\r\n                                Note: Employees can use their ID and PIN to log in to any authorized scanner device on the floor.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n\r\n            <style>{`\r\n                .btn-icon-danger {\r\n                    background: transparent; border: none; cursor: pointer;\r\n                    color: var(--text-secondary); padding: 8px; borderRadius: 8px;\r\n                    transition: all 0.2s;\r\n                }\r\n                .btn-icon-danger:hover {\r\n                    background: var(--error-bg); color: var(--error-color);\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Employees;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Login.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'logoCircleStyle' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":150,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":150,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"logoCircleStyle"},"fix":{"range":[7075,7351],"text":""},"desc":"Remove unused variable 'logoCircleStyle'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useConfig } from '../context/ConfigContext';\r\n\r\nconst Login = () => {\r\n    const { apiUrl, updateApiUrl } = useConfig();\r\n    const [credentials, setCredentials] = useState({ username: '', password: '' });\r\n    const [error, setError] = useState('');\r\n    const [showSettings, setShowSettings] = useState(false);\r\n    const [tempIp, setTempIp] = useState(apiUrl);\r\n    const navigate = useNavigate();\r\n\r\n    // Sync temp API URL with Context\r\n    React.useEffect(() => {\r\n        setTempIp(apiUrl);\r\n    }, [apiUrl]);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const res = await axios.post(`${apiUrl}/api/login`, credentials);\r\n            if (res.data.success && res.data.token) {\r\n                localStorage.setItem('ADMIN_TOKEN', res.data.token);\r\n                localStorage.setItem('isAuthenticated', 'true');\r\n                navigate('/dashboard');\r\n            }\r\n        } catch (err) {\r\n            console.error('Login Error:', err);\r\n            if (!err.response) {\r\n                setError('Network Error: Check Server URL or Cert');\r\n            } else if (err.response.status === 401) {\r\n                setError('Invalid Credentials');\r\n            } else {\r\n                setError(`Server Error: ${err.message}`);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={containerStyle}>\r\n            {/* Background Decorative Element */}\r\n            <div style={blobStyle}></div>\r\n\r\n            <button onClick={() => setShowSettings(true)} style={settingsBtnStyle}>ΓÜÖ∩╕Å</button>\r\n\r\n            <div className=\"panel animate-fade-in glass\" style={loginPanelStyle}>\r\n                <img src=\"/logo.svg\" alt=\"Prodexa\" style={{ height: '64px', marginBottom: '1rem' }} />\r\n                <h1 style={{ fontSize: '1.75rem', marginBottom: '0.25rem', fontWeight: '800', letterSpacing: '-0.03em' }}>Prodexa</h1>\r\n                <p style={{ fontSize: '0.85rem', color: 'var(--text-secondary)', marginBottom: '0.5rem', fontWeight: '500' }}>Warehouse Operations Software</p>\r\n                <div style={{ fontSize: '0.75rem', fontWeight: '700', color: 'var(--accent-color)', marginBottom: '2.5rem', opacity: 0.8 }}>For Sri Lakshmi Textiles</div>\r\n\r\n                {error && (\r\n                    <div style={errorStyle}>\r\n                        {error}\r\n                        {error.includes('Network Error') && (\r\n                            <div style={{ marginTop: '0.5rem', fontSize: '0.7rem' }}>\r\n                                <a href={`${apiUrl}/api/admin/server-ip`} target=\"_blank\" rel=\"noopener noreferrer\" style={{ color: 'white', textDecoration: 'underline' }}>\r\n                                    Click here to trust the server certificate\r\n                                </a>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>\r\n                    <div style={inputGroupStyle}>\r\n                        <label style={labelStyle}>Staff ID</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Enter username\"\r\n                            value={credentials.username}\r\n                            onChange={e => setCredentials({ ...credentials, username: e.target.value })}\r\n                            required\r\n                            style={{ width: '100%', padding: '0.8rem 1rem' }}\r\n                        />\r\n                    </div>\r\n                    <div style={inputGroupStyle}>\r\n                        <label style={labelStyle}>Access Key</label>\r\n                        <input\r\n                            type=\"password\"\r\n                            placeholder=\"ΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇó\"\r\n                            value={credentials.password}\r\n                            onChange={e => setCredentials({ ...credentials, password: e.target.value })}\r\n                            required\r\n                            style={{ width: '100%', padding: '0.8rem 1rem' }}\r\n                        />\r\n                    </div>\r\n                    <button type=\"submit\" className=\"btn btn-primary\" style={{ marginTop: '0.5rem', padding: '1rem' }}>\r\n                        AUTHENTICATE & ENTER\r\n                    </button>\r\n                </form>\r\n\r\n                <div style={footerStyle}>\r\n                    ESTABLISHED 2026 ΓÇó SYSTEM V2.4\r\n                    <div style={{ marginTop: '0.5rem', fontSize: '0.6rem', opacity: 0.5, fontFamily: 'monospace' }}>\r\n                        Server: {apiUrl}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Server Settings Modal */}\r\n            {showSettings && (\r\n                <div style={modalOverlayStyle}>\r\n                    <div className=\"panel glass animate-fade-in\" style={{ width: '360px' }}>\r\n                        <h3 style={{ marginBottom: '1rem' }}>Server Configuration</h3>\r\n                        <label style={labelStyle}>Backend Node URL</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={tempIp}\r\n                            onChange={(e) => setTempIp(e.target.value)}\r\n                            style={{ width: '100%', marginBottom: '1.5rem', fontFamily: 'monospace' }}\r\n                        />\r\n                        <div style={{ display: 'flex', gap: '1rem' }}>\r\n                            <button\r\n                                onClick={() => {\r\n                                    updateApiUrl(tempIp);\r\n                                    setShowSettings(false);\r\n                                    window.location.reload(); // Force reload to apply changes cleanly\r\n                                }}\r\n                                className=\"btn btn-primary\"\r\n                                style={{ flex: 1 }}\r\n                            >\r\n                                SAVE & RELOAD\r\n                            </button>\r\n                            <button onClick={() => setShowSettings(false)} className=\"btn btn-secondary\" style={{ flex: 1 }}>CANCEL</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst containerStyle = {\r\n    height: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n    background: 'var(--bg-primary)', position: 'relative', overflow: 'hidden'\r\n};\r\n\r\nconst blobStyle = {\r\n    position: 'absolute', width: '600px', height: '600px',\r\n    background: 'radial-gradient(circle, var(--accent-color) 0%, transparent 70%)',\r\n    opacity: 0.1, top: '-200px', right: '-200px', borderRadius: '50%', zIndex: 0\r\n};\r\n\r\nconst loginPanelStyle = {\r\n    width: '420px', padding: '3rem', textAlign: 'center', position: 'relative', zIndex: 1\r\n};\r\n\r\nconst logoCircleStyle = {\r\n    width: '48px', height: '48px', background: 'var(--accent-color)', color: 'white',\r\n    borderRadius: '12px', display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n    margin: '0 auto 1.5rem', fontSize: '1.5rem', fontWeight: '800'\r\n};\r\n\r\nconst inputGroupStyle = { textAlign: 'left', display: 'flex', flexDirection: 'column', gap: '0.5rem' };\r\nconst labelStyle = { fontSize: '0.7rem', fontWeight: '700', textTransform: 'uppercase', opacity: 0.5, letterSpacing: '0.05em' };\r\nconst errorStyle = { background: 'var(--error-bg)', color: 'var(--error-color)', padding: '0.75rem', borderRadius: '8px', fontSize: '0.8rem', marginBottom: '1.5rem', fontWeight: '600' };\r\nconst footerStyle = { marginTop: '3rem', fontSize: '0.65rem', color: 'var(--text-secondary)', letterSpacing: '0.1em', fontWeight: '600' };\r\nconst settingsBtnStyle = { position: 'absolute', top: '2rem', right: '2rem', background: 'none', border: 'none', cursor: 'pointer', fontSize: '1.25rem', opacity: 0.5 };\r\nconst modalOverlayStyle = { position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'var(--modal-overlay)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000 };\r\n\r\nexport default Login;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\MobileScanner.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Reports.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Scanners.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'deleting' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":16,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"deleting"},"fix":{"range":[735,743],"text":""},"desc":"Remove unused variable 'deleting'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchScanners'. Either include it or remove the dependency array.","line":22,"column":8,"nodeType":"ArrayExpression","endLine":22,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [apiUrl, fetchScanners]","fix":{"range":[943,951],"text":"[apiUrl, fetchScanners]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchServerIp'. Either include it or remove the dependency array.","line":27,"column":8,"nodeType":"ArrayExpression","endLine":27,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [fetchServerIp, qrTarget, serverIp]","fix":{"range":[1077,1097],"text":"[fetchServerIp, qrTarget, serverIp]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPairingToken'. Either include it or remove the dependency array.","line":36,"column":8,"nodeType":"ArrayExpression","endLine":36,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPairingToken, qrTarget]","fix":{"range":[1306,1316],"text":"[fetchPairingToken, qrTarget]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useConfig } from '../context/ConfigContext';\r\nimport axios from 'axios';\r\nimport QRCode from 'react-qr-code';\r\nimport { IconBroadcast, IconTrash, IconScan, IconX } from '../components/Icons';\r\n\r\nconst Scanners = () => {\r\n    const { apiUrl } = useConfig();\r\n    const [scanners, setScanners] = useState([]);\r\n    const [setupToken, setSetupToken] = useState('');\r\n    const [qrTarget, setQrTarget] = useState(null); // null, 'NEW', or scanner object\r\n    const [serverIp, setServerIp] = useState('');\r\n    const [error, setError] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [deleteConfirm, setDeleteConfirm] = useState(null);\r\n    const [deleting, setDeleting] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchScanners();\r\n        const interval = setInterval(fetchScanners, 5000);\r\n        return () => clearInterval(interval);\r\n    }, [apiUrl]);\r\n\r\n    // Fetch IP when QR modal opens\r\n    useEffect(() => {\r\n        if (qrTarget && !serverIp) fetchServerIp();\r\n    }, [qrTarget, serverIp]); // Optimized dependency\r\n\r\n    useEffect(() => {\r\n        if (qrTarget === 'NEW') {\r\n            fetchPairingToken();\r\n        }\r\n        if (!qrTarget) {\r\n            setSetupToken('');\r\n        }\r\n    }, [qrTarget]);\r\n\r\n    const authHeaders = () => {\r\n        const token = localStorage.getItem('ADMIN_TOKEN');\r\n        return token ? { Authorization: `Bearer ${token}` } : {};\r\n    };\r\n\r\n    const fetchServerIp = async () => {\r\n        try {\r\n            const res = await axios.get(`${apiUrl}/api/admin/server-ip`, { headers: authHeaders() });\r\n            if (res.data.ip) setServerIp(res.data.ip);\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch Server IP\", err);\r\n            setError(\"Could not resolve Server LAN IP\");\r\n        }\r\n    };\r\n\r\n    const fetchPairingToken = async () => {\r\n        try {\r\n            const res = await axios.get(`${apiUrl}/api/admin/pairing-token`, { headers: authHeaders() });\r\n            if (res.data.token) setSetupToken(res.data.token);\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch pairing token\", err);\r\n            setError(\"Could not generate pairing token\");\r\n        }\r\n    };\r\n\r\n    const fetchScanners = async () => {\r\n        try {\r\n            if (scanners.length === 0) setLoading(true);\r\n            const res = await axios.get(`${apiUrl}/api/admin/scanners`, { headers: authHeaders() });\r\n\r\n            // Prevent flickering: Only update state if data actually changed\r\n            setScanners(prev => {\r\n                const newData = res.data || [];\r\n                if (JSON.stringify(prev) !== JSON.stringify(newData)) {\r\n                    return newData;\r\n                }\r\n                return prev;\r\n            });\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch scanners:\", err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const removeScannerDevice = async (scannerId) => {\r\n        try {\r\n            setDeleting(true);\r\n            const res = await axios.delete(`${apiUrl}/api/admin/scanners/${scannerId}`, { headers: authHeaders() });\r\n            if (res.status === 200) {\r\n                setScanners(prev => prev.filter(s => s.scannerId !== scannerId));\r\n                setDeleteConfirm(null);\r\n            }\r\n        } catch (err) {\r\n            setError(`Error: ${err.response?.data?.error || 'Failed to remove scanner'}`);\r\n        } finally {\r\n            setDeleting(false);\r\n        }\r\n    };\r\n\r\n    const getPairingUrl = () => {\r\n        if (!serverIp) return '';\r\n        if (qrTarget === 'NEW' && !setupToken) return '';\r\n        const lanUrl = `https://${serverIp}:5000`;\r\n\r\n        // Use scanner's fingerprint for repair, otherwise use setupToken for new devices\r\n        const tokenToUse = (qrTarget && typeof qrTarget === 'object') ? qrTarget.fingerprint : setupToken;\r\n        const urlParams = `server=${encodeURIComponent(lanUrl)}`;\r\n\r\n        // Master Link that works with System Camera AND In-App Scanner\r\n        return `${lanUrl}/pwa/index.html?token=${tokenToUse}&${urlParams}&action=PAIR`;\r\n    };\r\n\r\n    return (\r\n        <div style={{ padding: '0', height: '100%', display: 'flex', flexDirection: 'column', background: 'var(--bg-primary)' }} className=\"animate-fade-in\">\r\n            {/* Header */}\r\n            <header style={{\r\n                padding: '1.5rem 2.5rem',\r\n                background: 'var(--bg-secondary)',\r\n                borderBottom: '1px solid var(--border-color)',\r\n                display: 'flex', justifyContent: 'space-between', alignItems: 'center'\r\n            }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '1.5rem' }}>\r\n                    <div style={{\r\n                        width: '48px', height: '48px', borderRadius: '12px',\r\n                        background: 'var(--bg-tertiary)', color: 'var(--text-primary)',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                    }}>\r\n                        <IconBroadcast />\r\n                    </div>\r\n                    <div>\r\n                        <div style={{ color: 'var(--accent-color)', fontWeight: '700', fontSize: '0.75rem', letterSpacing: '0.1em', marginBottom: '0.2rem' }}>DEVICE MANAGEMENT</div>\r\n                        <h1 style={{ fontSize: '1.5rem', fontWeight: '800', margin: 0, letterSpacing: '-0.02em', color: 'var(--text-primary)' }}>\r\n                            Scanner Fleet\r\n                        </h1>\r\n                    </div>\r\n                </div>\r\n                <button\r\n                    onClick={() => setQrTarget('NEW')}\r\n                    className=\"btn btn-primary\"\r\n                    style={{ padding: '0.8rem 1.5rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}\r\n                >\r\n                    <IconScan /> <span>Pair Device</span>\r\n                </button>\r\n            </header>\r\n\r\n            <div style={{ flex: 1, padding: '2rem 2.5rem', overflowY: 'auto' }}>\r\n\r\n                {error && (\r\n                    <div style={{ background: 'var(--error-bg)', color: 'var(--error-color)', padding: '1rem', borderRadius: '8px', marginBottom: '1.5rem', fontSize: '0.85rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\r\n                        <span>ΓÜá∩╕Å</span> {error}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Empty State */}\r\n                {scanners.length === 0 && !loading ? (\r\n                    <div style={{\r\n                        height: '60vh', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center',\r\n                        border: '2px dashed var(--border-color)', borderRadius: '16px', color: 'var(--text-secondary)'\r\n                    }}>\r\n                        <div style={{ fontSize: '4rem', marginBottom: '1rem', opacity: 0.2 }}>≡ƒô▒</div>\r\n                        <h3 style={{ margin: '0 0 0.5rem 0', fontSize: '1.2rem', color: 'var(--text-primary)' }}>No scanners connected</h3>\r\n                        <p style={{ margin: 0, opacity: 0.6, maxWidth: '400px', textAlign: 'center' }}>\r\n                            Your fleet is currently empty. Click the <b>Pair New Device</b> button above to connect a mobile scanner.\r\n                        </p>\r\n                    </div>\r\n                ) : (\r\n                    /* Grid */\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(340px, 1fr))', gap: '1.5rem' }}>\r\n                        {scanners.map((scanner) => {\r\n                            const lastSeenTime = new Date(scanner.lastSeen).getTime();\r\n                            const isActiveRecently = (Date.now() - lastSeenTime) < 2 * 60 * 1000;\r\n                            const statusDisplay = isActiveRecently ? 'Online' : 'Offline';\r\n                            const statusColor = isActiveRecently ? 'var(--success-color)' : 'var(--text-secondary)';\r\n                            const statusBg = isActiveRecently ? 'rgba(16, 185, 129, 0.1)' : 'var(--bg-tertiary)';\r\n\r\n                            return (\r\n                                <div key={scanner.scannerId} className=\"panel\" style={{\r\n                                    padding: '0', position: 'relative', overflow: 'hidden',\r\n                                    border: '1px solid var(--border-color)', borderRadius: '16px',\r\n                                    background: 'var(--bg-secondary)',\r\n                                    display: 'flex', flexDirection: 'column'\r\n                                }}>\r\n                                    {/* Card Header with Status */}\r\n                                    <div style={{ padding: '1.5rem', borderBottom: '1px solid var(--border-color)', display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                                        <div style={{ display: 'flex', gap: '1rem', alignItems: 'center' }}>\r\n                                            <div style={{\r\n                                                width: '48px', height: '48px', borderRadius: '12px',\r\n                                                background: 'var(--bg-tertiary)', color: 'var(--text-primary)',\r\n                                                display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.5rem'\r\n                                            }}>\r\n                                                ≡ƒô▒\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3 style={{ margin: '0', fontSize: '1.1rem', fontWeight: '700', color: 'var(--text-primary)' }}>\r\n                                                    {scanner.name || 'Unnamed Scanner'}\r\n                                                </h3>\r\n                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-secondary)', fontFamily: 'monospace', marginTop: '2px', opacity: 0.8 }}>\r\n                                                    UID: {scanner.scannerId.substring(0, 8)}...\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div style={{\r\n                                            padding: '4px 10px', borderRadius: '20px',\r\n                                            background: statusBg, color: statusColor,\r\n                                            fontSize: '0.7rem', fontWeight: '800', textTransform: 'uppercase', letterSpacing: '0.05em',\r\n                                            display: 'flex', alignItems: 'center', gap: '6px'\r\n                                        }}>\r\n                                            <span style={{ width: '6px', height: '6px', borderRadius: '50%', background: statusColor }}></span>\r\n                                            {statusDisplay}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Card Body */}\r\n                                    <div style={{ padding: '1.5rem', flex: 1 }}>\r\n                                        <div style={{ marginBottom: '1.5rem' }}>\r\n                                            <div style={{ fontSize: '0.7rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', marginBottom: '8px' }}>CURRENT USER</div>\r\n                                            {scanner.currentEmployee && scanner.currentEmployee.name ? (\r\n                                                <div style={{\r\n                                                    display: 'flex', alignItems: 'center', gap: '10px',\r\n                                                    background: 'rgba(99, 102, 241, 0.05)', padding: '10px 14px', borderRadius: '8px',\r\n                                                    border: '1px solid rgba(99, 102, 241, 0.1)'\r\n                                                }}>\r\n                                                    <div style={{ width: '32px', height: '32px', borderRadius: '50%', background: 'var(--accent-color)', color: 'white', display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: '700', fontSize: '0.85rem' }}>\r\n                                                        {scanner.currentEmployee.name.charAt(0)}\r\n                                                    </div>\r\n                                                    <div>\r\n                                                        <div style={{ fontWeight: '600', color: 'var(--text-primary)', fontSize: '0.9rem' }}>{scanner.currentEmployee.name}</div>\r\n                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-secondary)' }}>ID: {scanner.currentEmployee.employeeId}</div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ) : (\r\n                                                <div style={{ fontSize: '0.9rem', color: 'var(--text-secondary)', fontStyle: 'italic', padding: '10px 0' }}>No active user</div>\r\n                                            )}\r\n                                        </div>\r\n\r\n                                        <div>\r\n                                            <div style={{ fontSize: '0.7rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', marginBottom: '4px' }}>LAST SEEN</div>\r\n                                            <div style={{ fontSize: '0.9rem', fontWeight: '500', color: 'var(--text-primary)' }}>\r\n                                                {scanner.lastSeen ? new Date(scanner.lastSeen).toLocaleString() : 'Never'}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Card Footer Actions */}\r\n                                    <div style={{ padding: '1rem 1.5rem', background: 'var(--bg-tertiary)', borderTop: '1px solid var(--border-color)', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                                        {deleteConfirm === scanner.scannerId ? (\r\n                                            <div style={{ display: 'flex', gap: '0.5rem', width: '100%' }}>\r\n                                                <button\r\n                                                    onClick={() => removeScannerDevice(scanner.scannerId)}\r\n                                                    style={{ background: 'var(--error-bg)', color: 'var(--error-color)', border: 'none', padding: '8px 16px', borderRadius: '6px', fontSize: '0.8rem', fontWeight: '700', cursor: 'pointer', flex: 1 }}\r\n                                                >\r\n                                                    Confirm\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => setDeleteConfirm(null)}\r\n                                                    style={{ background: 'transparent', color: 'var(--text-secondary)', border: '1px solid var(--border-color)', padding: '8px', borderRadius: '6px', fontSize: '0.8rem', cursor: 'pointer' }}\r\n                                                >\r\n                                                    Cancel\r\n                                                </button>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <>\r\n                                                <button\r\n                                                    onClick={() => setQrTarget(scanner)}\r\n                                                    className=\"btn\"\r\n                                                    style={{ background: 'transparent', border: 'none', color: 'var(--accent-color)', padding: '0', fontSize: '0.85rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '6px' }}\r\n                                                >\r\n                                                    <IconScan size={16} /> Re-Pair Device\r\n                                                </button>\r\n\r\n                                                <button\r\n                                                    onClick={() => setDeleteConfirm(scanner.scannerId)}\r\n                                                    className=\"btn-icon-danger\"\r\n                                                    style={{ background: 'transparent', border: 'none', color: 'var(--text-secondary)', padding: '8px', cursor: 'pointer', opacity: 0.6, transition: 'opacity 0.2s' }}\r\n                                                    title=\"Remove Device\"\r\n                                                    onMouseEnter={e => e.target.style.opacity = 1}\r\n                                                    onMouseLeave={e => e.target.style.opacity = 0.6}\r\n                                                >\r\n                                                    <IconTrash size={16} />\r\n                                                </button>\r\n                                            </>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* QR Backdrop Modal */}\r\n            {qrTarget && (\r\n                <div style={{\r\n                    position: 'fixed', inset: 0, zIndex: 1000,\r\n                    background: 'var(--modal-overlay)', backdropFilter: 'blur(5px)',\r\n                    display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n                    padding: '20px'\r\n                }} className=\"animate-fade-in\">\r\n                    <div style={{\r\n                        width: '100%', maxWidth: '420px', background: 'var(--bg-secondary)',\r\n                        borderRadius: '24px', boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5)',\r\n                        border: '1px solid var(--border-color)', overflow: 'hidden',\r\n                        position: 'relative', display: 'flex', flexDirection: 'column',\r\n                        maxHeight: '90vh' // Ensure it fits on screen\r\n                    }}>\r\n                        {/* Close Button (X) */}\r\n                        <button\r\n                            onClick={() => setQrTarget(null)}\r\n                            style={{\r\n                                position: 'absolute', top: '15px', right: '15px',\r\n                                background: 'transparent', border: 'none', color: 'var(--text-secondary)',\r\n                                cursor: 'pointer', padding: '5px', zIndex: 10\r\n                            }}\r\n                        >\r\n                            <IconX />\r\n                        </button>\r\n\r\n                        <div style={{ padding: '2.5rem 2rem 2rem', textAlign: 'center', overflowY: 'auto' }}>\r\n                            <div style={{\r\n                                width: '64px', height: '64px', borderRadius: '20px',\r\n                                background: 'var(--accent-bg)', color: 'var(--accent-color)',\r\n                                margin: '0 auto 1.5rem', display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                            }}>\r\n                                <IconBroadcast />\r\n                            </div>\r\n\r\n                            <h2 style={{ fontSize: '1.5rem', fontWeight: '800', margin: '0 0 0.5rem', color: 'var(--text-primary)' }}>\r\n                                {qrTarget === 'NEW' ? 'Pair New Device' : `Repair ${qrTarget.name}`}\r\n                            </h2>\r\n                            <p style={{ fontSize: '0.9rem', color: 'var(--text-secondary)', margin: '0 0 2rem' }}>\r\n                                {qrTarget === 'NEW'\r\n                                    ? 'Scan this QR with any mobile device to connect it instantly.'\r\n                                    : `Use this QR to reconnect \"${qrTarget.name}\" if it lost connection or was logged out.`}\r\n                            </p>\r\n\r\n                            {!serverIp || (qrTarget === 'NEW' && !setupToken) ? (\r\n                                <div style={{ padding: '3rem', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\r\n                                    <div className=\"spinner\" style={{ width: '32px', height: '32px', border: '3px solid var(--border-color)', borderTopColor: 'var(--accent-color)', borderRadius: '50%' }}></div>\r\n                                    <p style={{ marginTop: '1rem', fontSize: '0.8rem', opacity: 0.7 }}>Generating Secure Link...</p>\r\n                                </div>\r\n                            ) : (\r\n                                <div style={{ background: 'white', padding: '1.5rem', borderRadius: '16px', display: 'inline-block', boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)' }}>\r\n                                    <QRCode value={getPairingUrl()} size={200} />\r\n                                </div>\r\n                            )}\r\n\r\n\r\n\r\n\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <style>{`\r\n                .spinner { animation: spin 1s linear infinite; }\r\n                @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }\r\n                .btn-icon-danger:hover { background: var(--error-bg) !important; color: var(--error-color) !important; }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Scanners;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Sessions.jsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchSessions` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  57 |             // Also refresh stats if in list view\n  58 |             if (!liveViewRef.current) {\n> 59 |                 fetchSessions();\n     |                 ^^^^^^^^^^^^^ `fetchSessions` accessed before it is declared\n  60 |             }\n  61 |         });\n  62 |\n\n  129 |     };\n  130 |\n> 131 |     const fetchSessions = async () => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 132 |         try {\n      | ^^^^^^^^^^^^^\n> 133 |             const res = await fetch(`${apiUrl}/api/sessions/active`);\n      ΓÇª\n      | ^^^^^^^^^^^^^\n> 140 |         }\n      | ^^^^^^^^^^^^^\n> 141 |     };\n      | ^^^^^^^ `fetchSessions` is declared here\n  142 |\n  143 |     const fetchSizes = async () => {\n  144 |         try {","line":59,"column":17,"nodeType":null,"endLine":59,"endColumn":30},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchHistory` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  64 |             console.log('≡ƒôí DESKTOP RECEIVED SESSION_UPDATE:', JSON.stringify(data));\n  65 |             fetchSessions();\n> 66 |             fetchHistory();\n     |             ^^^^^^^^^^^^ `fetchHistory` accessed before it is declared\n  67 |\n  68 |             // Auto-update live session counts if it's the one being monitored\n  69 |             if (liveViewRef.current && liveSessionRef.current && String(data.sessionId) === String(liveSessionRef.current._id)) {\n\n  153 |     }\n  154 |\n> 155 |     const fetchHistory = async () => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 156 |         try {\n      | ^^^^^^^^^^^^^\n> 157 |             let url = `${apiUrl}/api/sessions/history`;\n      ΓÇª\n      | ^^^^^^^^^^^^^\n> 170 |         }\n      | ^^^^^^^^^^^^^\n> 171 |     };\n      | ^^^^^^^ `fetchHistory` is declared here\n  172 |\n  173 |     useEffect(() => {\n  174 |         fetchHistory();","line":66,"column":13,"nodeType":null,"endLine":66,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchHistory' and 'fetchSessions'. Either include them or remove the dependency array.","line":102,"column":8,"nodeType":"ArrayExpression","endLine":102,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [apiUrl, fetchHistory, fetchSessions]","fix":{"range":[4313,4321],"text":"[apiUrl, fetchHistory, fetchSessions]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchHistory'. Either include it or remove the dependency array.","line":175,"column":8,"nodeType":"ArrayExpression","endLine":175,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [fetchHistory, filterDate]","fix":{"range":[6775,6787],"text":"[fetchHistory, filterDate]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchHistory', 'fetchSessions', and 'fetchSizes'. Either include them or remove the dependency array.","line":186,"column":8,"nodeType":"ArrayExpression","endLine":186,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [apiUrl, fetchHistory, fetchSessions, fetchSizes]","fix":{"range":[7111,7119],"text":"[apiUrl, fetchHistory, fetchSessions, fetchSizes]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'liveSession'. Either include it or remove the dependency array.","line":193,"column":8,"nodeType":"ArrayExpression","endLine":193,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [liveSession, sessions, showLiveView]","fix":{"range":[7353,7377],"text":"[liveSession, sessions, showLiveView]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { IconBroadcast, IconPlus, IconTrash } from '../components/Icons';\r\nimport { io } from \"socket.io-client\";\r\nimport { useConfig } from '../context/ConfigContext';\r\n\r\nconst Sessions = () => {\r\n    const { apiUrl } = useConfig();\r\n    const [sessions, setSessions] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [showCreateModal, setShowCreateModal] = useState(false);\r\n\r\n    // New Session Form State\r\n    const [sessionType, setSessionType] = useState('IN');\r\n    const [targetSize, setTargetSize] = useState('40');\r\n    const [sizes, setSizes] = useState([]);\r\n\r\n    // History State\r\n    const [history, setHistory] = useState([]);\r\n    const [showPreview, setShowPreview] = useState(false);\r\n    const [previewStats, setPreviewStats] = useState(null);\r\n    const [previewItems, setPreviewItems] = useState([]);\r\n    const [selectedSessionId, setSelectedSessionId] = useState(null);\r\n\r\n    // Report Preview State\r\n    const [showReportModal, setShowReportModal] = useState(false);\r\n    const [reportData, setReportData] = useState(null);\r\n\r\n    // Filters\r\n    const [filterDate, setFilterDate] = useState('');\r\n\r\n    // Live View State\r\n    const [showLiveView, setShowLiveView] = useState(false);\r\n    const [liveSession, setLiveSession] = useState(null);\r\n    const [liveScans, setLiveScans] = useState([]);\r\n\r\n    // Refs for Socket Listeners (To avoid constant reconnections)\r\n    const liveViewRef = useRef(showLiveView);\r\n    const liveSessionRef = useRef(liveSession);\r\n\r\n    useEffect(() => {\r\n        liveViewRef.current = showLiveView;\r\n        liveSessionRef.current = liveSession;\r\n    }, [showLiveView, liveSession]);\r\n\r\n    // Socket Connection\r\n    useEffect(() => {\r\n        const socket = io(apiUrl, {\r\n            rejectUnauthorized: false,\r\n            transports: ['websocket', 'polling']\r\n        });\r\n\r\n        socket.on('stock_update', (data) => {\r\n            // Use refs to check condition without needing effect to re-run\r\n            if (liveViewRef.current && liveSessionRef.current && String(data.sessionId) === String(liveSessionRef.current._id)) {\r\n                setLiveScans(prev => [data, ...prev].slice(0, 100)); // Keep last 100\r\n            }\r\n            // Also refresh stats if in list view\r\n            if (!liveViewRef.current) {\r\n                fetchSessions();\r\n            }\r\n        });\r\n\r\n        socket.on('session_update', async (data) => {\r\n            console.log('≡ƒôí DESKTOP RECEIVED SESSION_UPDATE:', JSON.stringify(data));\r\n            fetchSessions();\r\n            fetchHistory();\r\n\r\n            // Auto-update live session counts if it's the one being monitored\r\n            if (liveViewRef.current && liveSessionRef.current && String(data.sessionId) === String(liveSessionRef.current._id)) {\r\n                // Background fetch will handle liveSession update via sync effect\r\n            }\r\n\r\n            // Auto-show report when session ends (ONLY if initiated from desktop)\r\n            const isSessionEnd = data && data.action === 'ENDED' && data.sessionId;\r\n            const isDesktopInitiator = data.initiator === 'desktop';\r\n            \r\n            console.log('≡ƒöì CHECKING REPORT MODAL:', { \r\n                isSessionEnd, \r\n                initiator: data?.initiator, \r\n                isDesktopInitiator,\r\n                shouldShow: isSessionEnd && isDesktopInitiator\r\n            });\r\n            \r\n            if (isSessionEnd && isDesktopInitiator) {\r\n                console.log('Γ£à SHOWING REPORT - Session ended by desktop');\r\n                try {\r\n                    const res = await fetch(`${apiUrl}/api/sessions/${data.sessionId}/summary`);\r\n                    const report = await res.json();\r\n                    if (report.success) {\r\n                        setReportData(report);\r\n                        setShowReportModal(true);\r\n                    }\r\n                } catch (err) {\r\n                    console.error(\"Failed to auto-load report\", err);\r\n                }\r\n            } else if (isSessionEnd) {\r\n                console.log('Γ¥î NOT SHOWING REPORT - Session ended by:', data?.initiator || 'unknown (mobile/other)');\r\n            }\r\n        });\r\n\r\n        return () => socket.disconnect();\r\n    }, [apiUrl]);\r\n\r\n    const openLiveView = async (session) => {\r\n        setLiveSession(session);\r\n        setLiveScans([]); // Clear previous\r\n        setShowLiveView(true);\r\n\r\n        // Fetch existing items for this session to populate the monitor immediately\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sessions/${session._id}/preview`);\r\n            const data = await res.json();\r\n            if (data.success && data.items) {\r\n                const historicScans = data.items.map(item => ({\r\n                    barcode: item.barcode,\r\n                    timestamp: item.scannedAt,\r\n                    user: item.scannedBy,\r\n                    details: {\r\n                        metre: item.metre,\r\n                        weight: item.weight\r\n                    },\r\n                    sessionId: session._id\r\n                }));\r\n                setLiveScans(historicScans);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Failed to load session preview\", err);\r\n        }\r\n    };\r\n\r\n    const fetchSessions = async () => {\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sessions/active`);\r\n            const data = await res.json();\r\n            setSessions(Array.isArray(data) ? data : []);\r\n            setIsLoading(false);\r\n        } catch (err) {\r\n            console.error('Failed to fetch sessions', err);\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const fetchSizes = async () => {\r\n        try {\r\n\r\n            const resSizes = await fetch(`${apiUrl}/api/sizes`);\r\n            const data = await resSizes.json();\r\n            setSizes(data);\r\n            if (data.length > 0 && !targetSize) setTargetSize(data[0].code);\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch sizes\", err);\r\n        }\r\n    }\r\n\r\n    const fetchHistory = async () => {\r\n        try {\r\n            let url = `${apiUrl}/api/sessions/history`;\r\n            const params = new URLSearchParams();\r\n            if (filterDate) params.append('date', filterDate);\r\n\r\n            if (params.toString()) {\r\n                url += `?${params.toString()}`;\r\n            }\r\n\r\n            const res = await fetch(url);\r\n            const data = await res.json();\r\n            setHistory(Array.isArray(data) ? data : []);\r\n        } catch (err) {\r\n            console.error('Failed to fetch history', err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchHistory();\r\n    }, [filterDate]);\r\n\r\n    useEffect(() => {\r\n        fetchSessions();\r\n        fetchHistory();\r\n        fetchSizes();\r\n        const interval = setInterval(() => {\r\n            fetchSessions();\r\n            fetchHistory();\r\n        }, 2000); // Poll every 2 seconds for faster updates\r\n        return () => clearInterval(interval);\r\n    }, [apiUrl]);\r\n\r\n    useEffect(() => {\r\n        if (showLiveView && liveSession) {\r\n            const updated = sessions.find(s => String(s._id) === String(liveSession._id));\r\n            if (updated) setLiveSession(updated);\r\n        }\r\n    }, [sessions, showLiveView]);\r\n\r\n    const handleCreateSession = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sessions/create`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    type: sessionType,\r\n                    targetSize: targetSize,\r\n                    createdBy: 'Admin'\r\n                })\r\n            });\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setShowCreateModal(false);\r\n                fetchSessions();\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to create session', err);\r\n        }\r\n    };\r\n\r\n    const initiateCloseSession = async (sessionId) => {\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sessions/${sessionId}/preview`);\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setPreviewStats(data.stats);\r\n                setPreviewItems(data.items || []);\r\n                setSelectedSessionId(sessionId);\r\n                setShowPreview(true);\r\n            } else {\r\n                alert(\"Failed to get preview: \" + data.error);\r\n            }\r\n        } catch (err) {\r\n            alert(\"Error: \" + err.message);\r\n        }\r\n    };\r\n\r\n    const confirmCloseSession = async () => {\r\n        if (!selectedSessionId) return;\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sessions/end`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ sessionId: selectedSessionId, source: 'desktop' })\r\n            });\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setShowPreview(false);\r\n                setSelectedSessionId(null);\r\n                setPreviewStats(null);\r\n                fetchSessions();\r\n                fetchHistory();\r\n            } else {\r\n                alert(\"Failed to close: \" + data.error);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Failed to end session\", err);\r\n            alert(\"Error: \" + err.message);\r\n        }\r\n    }\r\n\r\n    const handleExport = (sessionId, type, size, reportType) => {\r\n        const url = `${apiUrl}/api/sessions/${sessionId}/export/${reportType}`;\r\n        window.open(url, '_blank');\r\n    };\r\n\r\n    const handleViewReport = async (sessionId) => {\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/sessions/${sessionId}/summary`);\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setReportData(data);\r\n                setShowReportModal(true);\r\n            } else {\r\n                alert(\"Failed to load report: \" + data.error);\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert(\"Failed to connect to server\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ padding: '2rem', height: '100%', overflowY: 'auto' }}>\r\n            <div className=\"animate-fade-in\" style={{ maxWidth: '1200px', margin: '0 auto', paddingBottom: '3rem' }}>\r\n\r\n                {/* Header Block */}\r\n                <div style={{ marginBottom: '3rem', display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                    <div>\r\n                        <div style={{ color: 'var(--accent-color)', fontWeight: '700', fontSize: '0.75rem', letterSpacing: '0.1em', marginBottom: '0.5rem' }}>REAL-TIME OPERATIONS</div>\r\n                        <h1 style={{ fontSize: '1.75rem', margin: 0 }}>Active Sessions</h1>\r\n                        <p style={{ opacity: 0.6, fontSize: '0.9rem' }}>Manage ongoing stock entry and dispatch sessions.</p>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={() => setShowCreateModal(true)}\r\n                        className=\"btn btn-primary\"\r\n                        style={{ padding: '0.8rem 1.5rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}\r\n                    >\r\n                        <span style={{ fontSize: '1.2rem' }}><IconPlus /></span>\r\n                        <span>Start New Session</span>\r\n                    </button>\r\n                </div>\r\n\r\n                {isLoading ? (\r\n                    <div style={{ textAlign: 'center', padding: '4rem', opacity: 0.5 }}>Loading active sessions...</div>\r\n                ) : (\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))', gap: '1.5rem' }}>\r\n                        {sessions.length === 0 && (\r\n                            <div style={{ gridColumn: '1/-1', textAlign: 'center', padding: '4rem 2rem', border: '2px dashed var(--border-color)', borderRadius: '16px', background: 'transparent' }}>\r\n                                <div style={{ fontSize: '3rem', marginBottom: '1rem', opacity: 0.3 }}>≡ƒôí</div>\r\n                                <h3 style={{ margin: '0 0 0.5rem 0', fontSize: '1.1rem', color: 'var(--text-secondary)' }}>No Active Sessions</h3>\r\n                                <p style={{ margin: 0, opacity: 0.6, fontSize: '0.9rem' }}>\r\n                                    Start a new session to begin scanning operations.\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n\r\n                        {sessions.map(session => {\r\n                            const isIN = session.type === 'IN';\r\n                            const statusColor = isIN ? 'var(--success-color)' : 'var(--error-color)';\r\n                            const statusBg = isIN ? 'rgba(16, 185, 129, 0.1)' : 'rgba(239, 68, 68, 0.1)';\r\n\r\n                            return (\r\n                                <div key={session._id} style={{\r\n                                    background: 'var(--bg-secondary)',\r\n                                    borderRadius: '16px',\r\n                                    border: '1px solid var(--border-color)',\r\n                                    padding: '1.5rem',\r\n                                    position: 'relative',\r\n                                    overflow: 'hidden',\r\n                                    boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',\r\n                                    transition: 'transform 0.2s ease, box-shadow 0.2s ease'\r\n                                }}\r\n                                    onMouseEnter={e => {\r\n                                        e.currentTarget.style.transform = 'translateY(-2px)';\r\n                                        e.currentTarget.style.boxShadow = '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)';\r\n                                    }}\r\n                                    onMouseLeave={e => {\r\n                                        e.currentTarget.style.transform = 'translateY(0)';\r\n                                        e.currentTarget.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';\r\n                                    }}\r\n                                >\r\n                                    {/* Top Bar */}\r\n                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>\r\n                                        <div style={{\r\n                                            padding: '4px 12px',\r\n                                            borderRadius: '20px',\r\n                                            background: statusBg,\r\n                                            color: statusColor,\r\n                                            fontSize: '0.75rem',\r\n                                            fontWeight: '700',\r\n                                            letterSpacing: '0.05em',\r\n                                            display: 'inline-flex',\r\n                                            alignItems: 'center',\r\n                                            gap: '6px'\r\n                                        }}>\r\n                                            <span style={{ width: '6px', height: '6px', borderRadius: '50%', background: statusColor }}></span>\r\n                                            {isIN ? 'STOCK IN' : 'DISPATCH'}\r\n                                        </div>\r\n                                        <div style={{ fontSize: '0.8rem', color: 'var(--text-secondary)', fontFamily: 'monospace' }}>\r\n                                            {new Date(session.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Main Content */}\r\n                                    <div style={{ textAlign: 'center', marginBottom: '2rem' }}>\r\n                                        <div style={{ fontSize: '0.8rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--text-secondary)', marginBottom: '0.5rem' }}>TARGET SIZE</div>\r\n                                        <div style={{ fontSize: '3.5rem', fontWeight: '800', lineHeight: 1, color: 'var(--text-primary)' }}>\r\n                                            {session.targetSize}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Stats Grid */}\r\n                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1.5rem', padding: '1rem 0', borderTop: '1px solid var(--border-color)', borderBottom: '1px solid var(--border-color)' }}>\r\n                                        <div style={{ textAlign: 'center', borderRight: '1px solid var(--border-color)' }}>\r\n                                            <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--accent-color)' }}>\r\n                                                {session.scannedCount || 0}\r\n                                            </div>\r\n                                            <div style={{ fontSize: '0.7rem', fontWeight: '600', color: 'var(--text-secondary)' }}>SCANNED</div>\r\n                                        </div>\r\n                                        <div style={{ textAlign: 'center' }}>\r\n                                            <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--text-primary)' }}>\r\n                                                {session.activeScanners ? session.activeScanners.length : 0}\r\n                                            </div>\r\n                                            <div style={{ fontSize: '0.7rem', fontWeight: '600', color: 'var(--text-secondary)' }}>A. SCANNERS</div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Actions */}\r\n                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                                        <button\r\n                                            onClick={() => openLiveView(session)}\r\n                                            style={{\r\n                                                background: 'var(--bg-primary)',\r\n                                                color: 'var(--text-primary)',\r\n                                                border: '1px solid var(--border-color)',\r\n                                                padding: '10px',\r\n                                                borderRadius: '8px',\r\n                                                cursor: 'pointer',\r\n                                                fontWeight: '600',\r\n                                                fontSize: '0.85rem',\r\n                                                display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '6px',\r\n                                                transition: 'all 0.2s'\r\n                                            }}\r\n                                            onMouseEnter={e => e.currentTarget.style.borderColor = 'var(--accent-color)'}\r\n                                            onMouseLeave={e => e.currentTarget.style.borderColor = 'var(--border-color)'}\r\n                                        >\r\n                                            <IconBroadcast size={16} /> Monitor\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => initiateCloseSession(session._id)}\r\n                                            style={{\r\n                                                background: 'rgba(239, 68, 68, 0.1)',\r\n                                                color: 'var(--error-color)',\r\n                                                border: '1px solid transparent',\r\n                                                padding: '10px',\r\n                                                borderRadius: '8px',\r\n                                                cursor: 'pointer',\r\n                                                fontWeight: '600',\r\n                                                fontSize: '0.85rem',\r\n                                                display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '6px',\r\n                                                transition: 'all 0.2s'\r\n                                            }}\r\n                                            onMouseEnter={e => {\r\n                                                e.currentTarget.style.background = 'var(--error-color)';\r\n                                                e.currentTarget.style.color = 'white';\r\n                                            }}\r\n                                            onMouseLeave={e => {\r\n                                                e.currentTarget.style.background = 'rgba(239, 68, 68, 0.1)';\r\n                                                e.currentTarget.style.color = 'var(--error-color)';\r\n                                            }}\r\n                                        >\r\n                                            End Session\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n\r\n                {/* HISTORY SECTION */}\r\n                <div style={{ marginTop: '4rem' }}>\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-end', marginBottom: '2rem' }}>\r\n                        <div>\r\n                            <h2 style={{ fontSize: '1.5rem', fontWeight: '800', margin: '0 0 0.5rem 0', color: 'var(--text-primary)' }}>Session History</h2>\r\n                            <p style={{ opacity: 0.6, fontSize: '0.9rem', margin: 0 }}>Review and export reports from previous operations.</p>\r\n                        </div>\r\n\r\n                        {/* Date Filter */}\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', background: 'var(--bg-tertiary)', padding: '6px 6px 6px 12px', borderRadius: '10px', border: '1px solid var(--border-color)' }}>\r\n                            <label style={{ fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em' }}>DATE:</label>\r\n                            <input\r\n                                type=\"date\"\r\n                                value={filterDate}\r\n                                onChange={(e) => setFilterDate(e.target.value)}\r\n                                style={{ background: 'transparent', border: 'none', color: 'var(--text-primary)', fontSize: '0.9rem', fontWeight: '600', outline: 'none', padding: '4px' }}\r\n                            />\r\n                            {filterDate && (\r\n                                <button\r\n                                    onClick={() => setFilterDate('')}\r\n                                    style={{ background: 'rgba(0,0,0,0.1)', border: 'none', borderRadius: '6px', width: '24px', height: '24px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', color: 'var(--text-secondary)' }}\r\n                                    title=\"Clear Date\"\r\n                                >\r\n                                    ├ù\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"panel\" style={{ padding: 0, overflow: 'hidden', border: '1px solid var(--border-color)', borderRadius: '16px' }}>\r\n                        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>\r\n                            <thead style={{ background: 'var(--bg-tertiary)', borderBottom: '1px solid var(--border-color)' }}>\r\n                                <tr>\r\n                                    <th style={{ padding: '1rem 1.5rem', textAlign: 'left', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em', width: '25%' }}>Date & Time</th>\r\n                                    <th style={{ padding: '1rem 1.5rem', textAlign: 'left', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em', width: '15%' }}>Type</th>\r\n                                    <th style={{ padding: '1rem 1.5rem', textAlign: 'center', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em', width: '15%' }}>Target Size</th>\r\n                                    <th style={{ padding: '1rem 1.5rem', textAlign: 'right', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em', width: '15%' }}>Items Scanned</th>\r\n                                    <th style={{ padding: '1rem 1.5rem', textAlign: 'right', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em', width: '30%' }}>Actions</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {history.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan=\"6\" style={{ padding: '4rem', textAlign: 'center', color: 'var(--text-secondary)' }}>\r\n                                            <div style={{ fontSize: '2rem', marginBottom: '1rem', opacity: 0.3 }}>≡ƒôà</div>\r\n                                            No session history found for selected range.\r\n                                        </td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    history.map(s => (\r\n                                        <tr key={s._id} style={{ borderBottom: '1px solid var(--border-color)', transition: 'background 0.2s' }} className=\"hover:bg-white/5\">\r\n                                            <td style={{ padding: '1rem 1.5rem' }}>\r\n                                                <div style={{ fontWeight: '600', color: 'var(--text-primary)' }}>{new Date(s.createdAt).toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' })}</div>\r\n                                                <div style={{ fontSize: '0.8rem', color: 'var(--text-secondary)', marginTop: '2px' }}>\r\n                                                    {new Date(s.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                                    {s.endedAt ? ` - ${new Date(s.endedAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}` : ''}\r\n                                                </div>\r\n                                            </td>\r\n                                            <td style={{ padding: '1rem 1.5rem' }}>\r\n                                                <span style={{\r\n                                                    padding: '4px 10px', borderRadius: '6px', fontSize: '0.75rem', fontWeight: '800', letterSpacing: '0.05em',\r\n                                                    background: s.type === 'IN' ? 'rgba(16, 185, 129, 0.1)' : 'rgba(239, 68, 68, 0.1)',\r\n                                                    color: s.type === 'IN' ? 'var(--success-color)' : 'var(--error-color)',\r\n                                                    border: `1px solid ${s.type === 'IN' ? 'rgba(16, 185, 129, 0.2)' : 'rgba(239, 68, 68, 0.2)'}`\r\n                                                }}>\r\n                                                    {s.type === 'IN' ? 'STOCK IN' : 'DISPATCH'}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td style={{ padding: '1rem 1.5rem', textAlign: 'center', fontWeight: '700', fontSize: '1rem' }}>\r\n                                                {s.targetSize}\r\n                                            </td>\r\n                                            <td style={{ padding: '1rem 1.5rem', textAlign: 'right', fontFamily: 'monospace', fontSize: '1rem', fontWeight: '700' }}>\r\n                                                {s.totalItems !== undefined ? s.totalItems : (s.scannedCount || 0)}\r\n                                            </td>\r\n\r\n                                            <td style={{ padding: '1rem 1.5rem', textAlign: 'right' }}>\r\n                                                <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>\r\n                                                    <button\r\n                                                        onClick={() => handleExport(s._id, s.type, s.targetSize, 'summary')}\r\n                                                        className=\"btn\"\r\n                                                        style={{ padding: '6px 12px', fontSize: '0.8rem', background: 'var(--bg-primary)', border: '1px solid var(--border-color)', color: 'var(--text-primary)' }}\r\n                                                        title=\"Download Excel Summary\"\r\n                                                    >\r\n                                                        ≡ƒôè Export\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => handleViewReport(s._id)}\r\n                                                        className=\"btn\"\r\n                                                        style={{ padding: '6px 12px', fontSize: '0.8rem', background: 'rgba(99, 102, 241, 0.1)', border: 'none', color: 'var(--accent-color)' }}\r\n                                                    >\r\n                                                        ≡ƒæü∩╕Å View\r\n                                                    </button>\r\n                                                </div>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* LIVE VIEW MODAL */}\r\n            {showLiveView && liveSession && (\r\n                <div style={{\r\n                    position: 'fixed', inset: 0, zIndex: 1100,\r\n                    background: 'var(--modal-overlay)', backdropFilter: 'blur(5px)',\r\n                    display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                }}>\r\n                    <div className=\"panel animate-fade-in\" style={{ width: '90%', maxWidth: '900px', height: '80vh', display: 'flex', flexDirection: 'column', padding: 0, overflow: 'hidden' }}>\r\n                        {/* Live Header */}\r\n                        <div style={{ padding: '1.5rem 2rem', borderBottom: '1px solid var(--border-color)', display: 'flex', justifyContent: 'space-between', alignItems: 'center', background: 'var(--bg-secondary)' }}>\r\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n                                <div className=\"live-indicator\">\r\n                                    <span className=\"blink\">ΓùÅ</span> LIVE FEED\r\n                                </div>\r\n                                <div style={{ height: '20px', width: '1px', background: 'var(--border-color)' }}></div>\r\n                                <div>\r\n                                    <h2 style={{ fontSize: '1.2rem', margin: 0 }}>Session Monitor</h2>\r\n                                    <div style={{ fontSize: '0.8rem', opacity: 0.6 }}>target size {liveSession.targetSize} ΓÇó {liveSession.type} Flow</div>\r\n                                </div>\r\n                            </div>\r\n                            <button onClick={() => setShowLiveView(false)} className=\"btn\" style={{ padding: '8px 16px', border: '1px solid var(--border-color)', background: 'transparent' }}>CLOSE MONITOR</button>\r\n                        </div>\r\n\r\n                        <div style={{ display: 'flex', flex: 1, overflow: 'hidden' }}>\r\n                            {/* Stats Side */}\r\n                            <div style={{ width: '250px', padding: '1.5rem', borderRight: '1px solid var(--border-color)', background: 'rgba(0,0,0,0.1)' }}>\r\n                                <div style={{ marginBottom: '2rem' }}>\r\n                                    <div style={{ fontSize: '0.7rem', fontWeight: '800', opacity: 0.5, marginBottom: '0.5rem' }}>ACTIVE SCANNERS</div>\r\n                                    <div style={{ fontSize: '2.5rem', fontWeight: '800', color: 'var(--accent-color)' }}>\r\n                                        {liveSession.activeScanners ? liveSession.activeScanners.length : 0}\r\n                                    </div>\r\n                                    <div style={{ fontSize: '0.8rem', opacity: 0.7 }}>Devices Connected</div>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <div style={{ fontSize: '0.7rem', fontWeight: '800', opacity: 0.5, marginBottom: '0.5rem' }}>SESSION TOTAL</div>\r\n                                    <div style={{ fontSize: '2.5rem', fontWeight: '800' }}>\r\n                                        {liveSession.scannedCount || 0}\r\n                                    </div>\r\n                                    <div style={{ fontSize: '0.8rem', opacity: 0.7 }}>Items Scanned</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Live Feed */}\r\n                            <div style={{ flex: 1, padding: '0', overflowY: 'auto', background: 'var(--bg-primary)' }}>\r\n                                {liveScans.length === 0 ? (\r\n                                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', height: '100%', opacity: 0.4 }}>\r\n                                        <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>≡ƒôí</div>\r\n                                        <p>Waiting for incoming scans...</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                                        <thead style={{ position: 'sticky', top: 0, background: 'var(--bg-secondary)', borderBottom: '1px solid var(--border-color)' }}>\r\n                                            <tr>\r\n                                                <th style={{ padding: '12px 20px', textAlign: 'left', fontSize: '0.75rem', opacity: 0.6 }}>TIME</th>\r\n                                                <th style={{ padding: '12px 20px', textAlign: 'left', fontSize: '0.75rem', opacity: 0.6 }}>BARCODE</th>\r\n                                                <th style={{ padding: '12px 20px', textAlign: 'right', fontSize: '0.75rem', opacity: 0.6 }}>METRE</th>\r\n                                                <th style={{ padding: '12px 20px', textAlign: 'right', fontSize: '0.75rem', opacity: 0.6 }}>WEIGHT</th>\r\n                                                <th style={{ padding: '12px 20px', textAlign: 'right', fontSize: '0.75rem', opacity: 0.6 }}>USER</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {liveScans.map((scan, i) => (\r\n                                                <tr key={i} className=\"animate-slide-in\" style={{ borderBottom: '1px solid var(--border-color)', animationDelay: `${i * 0.05}s` }}>\r\n                                                    <td style={{ padding: '12px 20px', fontFamily: 'monospace' }}>\r\n                                                        {new Date(scan.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' })}\r\n                                                    </td>\r\n                                                    <td style={{ padding: '12px 20px', fontWeight: 'bold', color: 'var(--accent-color)', fontFamily: 'monospace' }}>\r\n                                                        {scan.barcode}\r\n                                                    </td>\r\n                                                    <td style={{ padding: '12px 20px', textAlign: 'right' }}>{scan.details?.metre}</td>\r\n                                                    <td style={{ padding: '12px 20px', textAlign: 'right' }}>{scan.details?.weight}</td>\r\n                                                    <td style={{ padding: '12px 20px', textAlign: 'right', opacity: 0.8 }}>{scan.user || 'Unknown'}</td>\r\n                                                </tr>\r\n                                            ))}\r\n                                        </tbody>\r\n                                    </table>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <style>{`\r\n                        .blink { animation: blinker 1.5s linear infinite; color: var(--error-color); margin-right: 6px; }\r\n                        @keyframes blinker { 50% { opacity: 0; } }\r\n                        .live-indicator { display: flex; alignItems: center; font-size: 0.75rem; font-weight: 800; letter-spacing: 1px; color: var(--error-color); background: rgba(239, 68, 68, 0.1); padding: 4px 10px; border-radius: 20px; border: 1px solid rgba(239, 68, 68, 0.2); }\r\n                    `}</style>\r\n                </div>\r\n            )}\r\n\r\n            {/* PREVIEW MODAL */}\r\n            {showPreview && previewStats && (\r\n                <div style={{\r\n                    position: 'fixed', inset: 0, zIndex: 2000,\r\n                    background: 'var(--modal-overlay)', backdropFilter: 'blur(8px)',\r\n                    display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                }}>\r\n                    <div className=\"panel animate-fade-in\" style={{ width: '100%', maxWidth: '800px', maxHeight: '90vh', padding: '0', position: 'relative', display: 'flex', flexDirection: 'column', overflow: 'hidden' }}>\r\n\r\n                        <div style={{ padding: '2rem', textAlign: 'center', borderBottom: '1px solid var(--border-color)' }}>\r\n                            <div style={{ fontSize: '3rem', marginBottom: '0.5rem' }}>≡ƒÅü</div>\r\n                            <h2 style={{ fontSize: '1.5rem', marginBottom: '0.5rem' }}>End Session?</h2>\r\n                            <p style={{ opacity: 0.6 }}>Review the session summary before closing.</p>\r\n                        </div>\r\n\r\n                        <div style={{ padding: '2rem', overflowY: 'auto', flex: 1 }}>\r\n                            {/* Stats Cards */}\r\n                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '1rem', marginBottom: '2rem' }}>\r\n                                <div style={{ background: 'var(--bg-secondary)', padding: '1.5rem', borderRadius: '12px', textAlign: 'center' }}>\r\n                                    <div style={{ fontSize: '2rem', fontWeight: '700' }}>{previewStats.totalCount}</div>\r\n                                    <div style={{ fontSize: '0.75rem', opacity: 0.5, fontWeight: '700', letterSpacing: '1px' }}>ITEMS</div>\r\n                                </div>\r\n                                <div style={{ background: 'var(--bg-secondary)', padding: '1.5rem', borderRadius: '12px', textAlign: 'center' }}>\r\n                                    <div style={{ fontSize: '2rem', fontWeight: '700', color: 'var(--success-color)' }}>{previewStats.totalWeight.toFixed(1)}</div>\r\n                                    <div style={{ fontSize: '0.75rem', opacity: 0.5, fontWeight: '700', letterSpacing: '1px' }}>KG WEIGHT</div>\r\n                                </div>\r\n                                <div style={{ background: 'var(--bg-secondary)', padding: '1.5rem', borderRadius: '12px', textAlign: 'center' }}>\r\n                                    <div style={{ fontSize: '2rem', fontWeight: '700', color: 'var(--accent-color)' }}>{previewStats.totalMetre.toFixed(1)}</div>\r\n                                    <div style={{ fontSize: '0.75rem', opacity: 0.5, fontWeight: '700', letterSpacing: '1px' }}>TOTAL METRE</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Items List */}\r\n                            <h3 style={{ fontSize: '1.1rem', marginBottom: '1rem', opacity: 0.8 }}>Item Details</h3>\r\n                            <div style={{ border: '1px solid var(--border-color)', borderRadius: '12px', overflow: 'hidden' }}>\r\n                                <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>\r\n                                    <thead style={{ background: 'var(--bg-secondary)', borderBottom: '1px solid var(--border-color)' }}>\r\n                                        <tr>\r\n                                            <th style={{ padding: '12px', textAlign: 'left', opacity: 0.7 }}>Barcode</th>\r\n                                            <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Metre</th>\r\n                                            <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Weight</th>\r\n                                            <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>User</th>\r\n                                            <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Time</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {previewItems && previewItems.length > 0 ? (\r\n                                            previewItems.map((item, idx) => (\r\n                                                <tr key={idx} style={{ borderBottom: '1px solid var(--border-color)' }}>\r\n                                                    <td style={{ padding: '10px 12px', fontFamily: 'monospace', fontWeight: 'bold' }}>{item.barcode}</td>\r\n                                                    <td style={{ padding: '10px 12px', textAlign: 'right' }}>{item.metre}</td>\r\n                                                    <td style={{ padding: '10px 12px', textAlign: 'right' }}>{item.weight}</td>\r\n                                                    <td style={{ padding: '10px 12px', textAlign: 'right', opacity: 0.8 }}>{item.scannedBy}</td>\r\n                                                    <td style={{ padding: '10px 12px', textAlign: 'right', opacity: 0.6, fontSize: '0.8rem' }}>\r\n                                                        {item.scannedAt ? new Date(item.scannedAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '-'}\r\n                                                    </td>\r\n                                                </tr>\r\n                                            ))\r\n                                        ) : (\r\n                                            <tr>\r\n                                                <td colSpan=\"5\" style={{ padding: '2rem', textAlign: 'center', opacity: 0.5 }}>No items found</td>\r\n                                            </tr>\r\n                                        )}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div style={{ padding: '1.5rem', borderTop: '1px solid var(--border-color)', display: 'flex', gap: '1rem', background: 'var(--bg-secondary)' }}>\r\n                            <button\r\n                                onClick={() => setShowPreview(false)}\r\n                                className=\"btn\"\r\n                                style={{ flex: 1, background: 'transparent', border: '1px solid var(--border-color)' }}\r\n                            >\r\n                                Cancel\r\n                            </button>\r\n                            <button\r\n                                onClick={confirmCloseSession}\r\n                                className=\"btn btn-primary\"\r\n                                style={{ flex: 2, background: 'var(--error-color)', border: 'none' }}\r\n                            >\r\n                                Confirm & Close\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n\r\n\r\n            {/* REPORT PREVIEW MODAL */}\r\n            {\r\n                showReportModal && reportData && (\r\n                    <div style={{\r\n                        position: 'fixed', inset: 0, zIndex: 3000,\r\n                        background: 'var(--modal-overlay)', backdropFilter: 'blur(8px)',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '2rem'\r\n                    }}>\r\n                        <div className=\"panel animate-fade-in\" style={{ width: '100%', maxWidth: '800px', maxHeight: '90vh', display: 'flex', flexDirection: 'column', padding: '0', overflow: 'hidden' }}>\r\n                            {/* Header */}\r\n                            <div style={{ padding: '1.5rem 2rem', borderBottom: '1px solid var(--border-color)', display: 'flex', justifyContent: 'space-between', alignItems: 'center', background: 'var(--bg-secondary)' }}>\r\n                                <div>\r\n                                    <h2 style={{ fontSize: '1.25rem', margin: 0 }}>Session Report</h2>\r\n                                    <div style={{ fontSize: '0.8rem', opacity: 0.6, marginTop: '4px' }}>\r\n                                        ID: {reportData.session._id} | Size: {reportData.session.targetSize} | {new Date(reportData.session.createdAt).toLocaleDateString()}\r\n                                    </div>\r\n                                </div>\r\n                                <button onClick={() => setShowReportModal(false)} style={{ background: 'none', border: 'none', fontSize: '1.5rem', cursor: 'pointer', color: 'var(--text-secondary)' }}>├ù</button>\r\n                            </div>\r\n\r\n                            {/* Content */}\r\n                            <div style={{ padding: '2rem', overflowY: 'auto' }}>\r\n\r\n                                <h3 style={{ fontSize: '1rem', marginBottom: '1rem', opacity: 0.7, textTransform: 'uppercase', letterSpacing: '1px' }}>Employee Summary</h3>\r\n                                <div style={{ marginBottom: '3rem', border: '1px solid var(--border-color)', borderRadius: '12px', overflow: 'hidden' }}>\r\n                                    <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                                        <thead style={{ background: 'var(--bg-secondary)', borderBottom: '1px solid var(--border-color)' }}>\r\n                                            <tr style={{ textAlign: 'left' }}>\r\n                                                <th style={{ padding: '12px', opacity: 0.7 }}>Employee</th>\r\n                                                <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Count</th>\r\n                                                <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Tot. Metre</th>\r\n                                                <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Tot. Weight</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {reportData.stats.map((stat, i) => (\r\n                                                <tr key={i} style={{ borderBottom: '1px solid var(--border-color)' }}>\r\n                                                    <td style={{ padding: '12px', fontWeight: '600' }}>{stat._id || 'Unknown'}</td>\r\n                                                    <td style={{ padding: '12px', textAlign: 'right', fontFamily: 'monospace' }}>{stat.count}</td>\r\n                                                    <td style={{ padding: '12px', textAlign: 'right', fontFamily: 'monospace', color: 'var(--accent-color)' }}>{stat.totalMetre.toFixed(2)}</td>\r\n                                                    <td style={{ padding: '12px', textAlign: 'right', fontFamily: 'monospace', color: 'var(--success-color)' }}>{stat.totalWeight.toFixed(2)}</td>\r\n                                                </tr>\r\n                                            ))}\r\n                                            {/* Grand Total Row */}\r\n                                            <tr style={{ background: 'rgba(255,255,255,0.02)' }}>\r\n                                                <td style={{ padding: '16px', fontWeight: '800' }}>GRAND TOTAL</td>\r\n                                                <td style={{ padding: '16px', textAlign: 'right', fontWeight: '800' }}>\r\n                                                    {reportData.stats.reduce((acc, curr) => acc + curr.count, 0)}\r\n                                                </td>\r\n                                                <td style={{ padding: '16px', textAlign: 'right', fontWeight: '800', color: 'var(--accent-color)' }}>\r\n                                                    {reportData.stats.reduce((acc, curr) => acc + curr.totalMetre, 0).toFixed(2)}\r\n                                                </td>\r\n                                                <td style={{ padding: '16px', textAlign: 'right', fontWeight: '800', color: 'var(--success-color)' }}>\r\n                                                    {reportData.stats.reduce((acc, curr) => acc + curr.totalWeight, 0).toFixed(2)}\r\n                                                </td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n\r\n                                {/* Items List */}\r\n                                <h3 style={{ fontSize: '1rem', marginBottom: '1rem', opacity: 0.7, textTransform: 'uppercase', letterSpacing: '1px' }}>Detailed Items List</h3>\r\n                                <div style={{ border: '1px solid var(--border-color)', borderRadius: '12px', overflow: 'hidden' }}>\r\n                                    <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.9rem' }}>\r\n                                        <thead style={{ background: 'var(--bg-secondary)', borderBottom: '1px solid var(--border-color)' }}>\r\n                                            <tr style={{ textAlign: 'left' }}>\r\n                                                <th style={{ padding: '12px', opacity: 0.7 }}>Barcode</th>\r\n                                                <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Metre</th>\r\n                                                <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Weight</th>\r\n                                                <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>User</th>\r\n                                                <th style={{ padding: '12px', textAlign: 'right', opacity: 0.7 }}>Time</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {reportData.items && reportData.items.length > 0 ? (\r\n                                                reportData.items.map((item, idx) => (\r\n                                                    <tr key={idx} style={{ borderBottom: '1px solid var(--border-color)' }}>\r\n                                                        <td style={{ padding: '10px 12px', fontFamily: 'monospace', fontWeight: 'bold' }}>{item.barcode}</td>\r\n                                                        <td style={{ padding: '10px 12px', textAlign: 'right' }}>{item.metre}</td>\r\n                                                        <td style={{ padding: '10px 12px', textAlign: 'right' }}>{item.weight}</td>\r\n                                                        <td style={{ padding: '10px 12px', textAlign: 'right', opacity: 0.8 }}>{item.scannedBy}</td>\r\n                                                        <td style={{ padding: '10px 12px', textAlign: 'right', opacity: 0.6, fontSize: '0.8rem' }}>\r\n                                                            {item.scannedAt ? new Date(item.scannedAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '-'}\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                ))\r\n                                            ) : (\r\n                                                <tr>\r\n                                                    <td colSpan=\"5\" style={{ padding: '2rem', textAlign: 'center', opacity: 0.5 }}>No items found</td>\r\n                                                </tr>\r\n                                            )}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Footer */}\r\n                            <div style={{ padding: '1.5rem', borderTop: '1px solid var(--border-color)', background: 'var(--bg-secondary)', textAlign: 'right' }}>\r\n                                <button className=\"btn\" onClick={() => setShowReportModal(false)} style={{ padding: '8px 24px', background: 'var(--border-color)', border: 'none' }}>Close</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n\r\n            {/* Create Modal */}\r\n            {\r\n                showCreateModal && (\r\n                    <div style={{\r\n                        position: 'fixed', inset: 0, zIndex: 1000,\r\n                        background: 'var(--modal-overlay)', backdropFilter: 'blur(8px)',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                    }}>\r\n                        <div className=\"panel animate-fade-in\" style={{ width: '100%', maxWidth: '420px', padding: '2.5rem', position: 'relative' }}>\r\n                            <h2 style={{ fontSize: '1.5rem', marginBottom: '2rem', textAlign: 'center' }}>Start New Session</h2>\r\n\r\n                            <form onSubmit={handleCreateSession}>\r\n                                <div style={{ marginBottom: '1.5rem' }}>\r\n                                    <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.75rem', fontWeight: '700', opacity: 0.7 }}>OPERATION TYPE</label>\r\n                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            onClick={() => setSessionType('IN')}\r\n                                            style={{\r\n                                                padding: '1rem', borderRadius: '12px', border: sessionType === 'IN' ? '2px solid var(--success-color)' : '1px solid var(--border-color)',\r\n                                                background: sessionType === 'IN' ? 'rgba(16, 185, 129, 0.1)' : 'transparent',\r\n                                                color: sessionType === 'IN' ? 'var(--success-color)' : 'var(--text-secondary)',\r\n                                                fontWeight: '700', cursor: 'pointer'\r\n                                            }}\r\n                                        >\r\n                                            STOCK IN\r\n                                        </button>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            onClick={() => setSessionType('OUT')}\r\n                                            style={{\r\n                                                padding: '1rem', borderRadius: '12px', border: sessionType === 'OUT' ? '2px solid var(--error-color)' : '1px solid var(--border-color)',\r\n                                                background: sessionType === 'OUT' ? 'rgba(239, 68, 68, 0.1)' : 'transparent',\r\n                                                color: sessionType === 'OUT' ? 'var(--error-color)' : 'var(--text-secondary)',\r\n                                                fontWeight: '700', cursor: 'pointer'\r\n                                            }}\r\n                                        >\r\n                                            STOCK OUT\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div style={{ marginBottom: '2rem' }}>\r\n                                    <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.75rem', fontWeight: '700', opacity: 0.7 }}>TARGET SIZE</label>\r\n                                    <select\r\n                                        value={targetSize}\r\n                                        onChange={(e) => setTargetSize(e.target.value)}\r\n                                        style={{\r\n                                            width: '100%', padding: '1rem', background: 'var(--bg-secondary)', border: '1px solid var(--border-color)',\r\n                                            borderRadius: '12px', color: 'var(--text-primary)', fontSize: '1.1rem', fontWeight: '600', outline: 'none'\r\n                                        }}\r\n                                    >\r\n                                        {sizes.map(s => (\r\n                                            <option key={s._id} value={s.code}>{s.code}</option>\r\n                                        ))}\r\n                                        {sizes.length === 0 && <option value=\"40\">40</option>}\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div style={{ display: 'flex', gap: '1rem' }}>\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={() => setShowCreateModal(false)}\r\n                                        className=\"btn\"\r\n                                        style={{ flex: 1, background: 'transparent', border: '1px solid var(--border-color)' }}\r\n                                    >\r\n                                        Cancel\r\n                                    </button>\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        className=\"btn btn-primary\"\r\n                                        style={{ flex: 2 }}\r\n                                    >\r\n                                        Start Session\r\n                                    </button>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n        </div >\r\n    );\r\n};\r\n\r\n\r\n\r\n\r\nexport default Sessions;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\src\\pages\\Settings.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchBackups', 'fetchConfig', and 'fetchSystemInfo'. Either include them or remove the dependency array.","line":21,"column":8,"nodeType":"ArrayExpression","endLine":21,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [apiUrl, fetchBackups, fetchConfig, fetchSystemInfo]","fix":{"range":[813,821],"text":"[apiUrl, fetchBackups, fetchConfig, fetchSystemInfo]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":63,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":77,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":108,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":25}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useConfig } from '../context/ConfigContext';\r\nimport { IconSettings, IconCloud, IconScan } from '../components/Icons';\r\n\r\nconst Settings = () => {\r\n    const { apiUrl, updateApiUrl, theme, toggleTheme } = useConfig();\r\n    const [activeTab, setActiveTab] = useState('general');\r\n    const [backupPath, setBackupPath] = useState('');\r\n    const [backups, setBackups] = useState([]);\r\n    const [loadingBackups, setLoadingBackups] = useState(false);\r\n    const [backupMsg, setBackupMsg] = useState('');\r\n\r\n    // System Info State\r\n    const [serverIp, setServerIp] = useState('Loading...');\r\n    const [scanners, setScanners] = useState([]);\r\n\r\n    useEffect(() => {\r\n        fetchConfig();\r\n        fetchBackups();\r\n        fetchSystemInfo();\r\n    }, [apiUrl]);\r\n\r\n    const fetchConfig = async () => {\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/admin/config/backup-path`);\r\n            const data = await res.json();\r\n            if (data.path) setBackupPath(data.path);\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    const fetchBackups = async () => {\r\n        setLoadingBackups(true);\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/admin/backups`);\r\n            const data = await res.json();\r\n            setBackups(Array.isArray(data) ? data : []);\r\n        } catch (err) { console.error(err); }\r\n        finally { setLoadingBackups(false); }\r\n    };\r\n\r\n    const fetchSystemInfo = async () => {\r\n        try {\r\n            // Fetch IP\r\n            const resIp = await fetch(`${apiUrl}/api/admin/server-ip`);\r\n            const dataIp = await resIp.json();\r\n            setServerIp(dataIp.ip);\r\n\r\n            // Fetch Scanners for count\r\n            const resScan = await fetch(`${apiUrl}/api/admin/scanners`);\r\n            const dataScan = await resScan.json();\r\n            setScanners(dataScan);\r\n        } catch (err) { console.error(err); }\r\n    };\r\n\r\n    const handleSavePath = async () => {\r\n        try {\r\n            await fetch(`${apiUrl}/api/admin/config/backup-path`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ path: backupPath })\r\n            });\r\n            alert('Backup path updated successfully');\r\n        } catch (err) { alert('Failed to update path'); }\r\n    };\r\n\r\n    const handleCreateBackup = async () => {\r\n        setBackupMsg('Creating backup...');\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/admin/backup`, { method: 'POST' });\r\n            const data = await res.json();\r\n            if (res.ok) {\r\n                setBackupMsg(`Backup created: ${data.filename}`);\r\n                fetchBackups();\r\n            } else {\r\n                setBackupMsg(`Error: ${data.error}`);\r\n            }\r\n        } catch (err) { setBackupMsg('Failed to create backup'); }\r\n    };\r\n\r\n    const handleImportBackup = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n\r\n        if (!window.confirm('WARNING: Restoring a backup will OVERWRITE all current data. This action cannot be undone. Continue?')) {\r\n            return;\r\n        }\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = async (e) => {\r\n            try {\r\n                const content = JSON.parse(e.target.result);\r\n                setBackupMsg('Restoring data...');\r\n\r\n                const res = await fetch(`${apiUrl}/api/admin/restore`, {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({ fileContent: content })\r\n                });\r\n\r\n                const data = await res.json();\r\n                if (res.ok) {\r\n                    alert('System restored successfully. The page will reload.');\r\n                    window.location.reload();\r\n                } else {\r\n                    alert(`Restore failed: ${data.error}`);\r\n                    setBackupMsg('');\r\n                }\r\n            } catch (err) {\r\n                alert('Invalid backup file format');\r\n                setBackupMsg('');\r\n            }\r\n        };\r\n        reader.readAsText(file);\r\n    };\r\n\r\n    const handleRestore = async (filename) => {\r\n        if (!window.confirm(`Restore from ${filename}? Current data will be replaced.`)) return;\r\n\r\n        try {\r\n            const res = await fetch(`${apiUrl}/api/admin/restore`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ filename })\r\n            });\r\n            if (res.ok) {\r\n                alert('Restore complete. Reloading...');\r\n                window.location.reload();\r\n            } else {\r\n                alert('Restore failed');\r\n            }\r\n        } catch (err) { console.error(err); alert('Restore failed'); }\r\n    };\r\n\r\n    const handleDownload = async (filename) => {\r\n        try {\r\n            setBackupMsg('Downloading...');\r\n            const res = await fetch(`${apiUrl}/api/admin/backup/download/${filename}`, {\r\n                headers: { 'Authorization': `Bearer ${localStorage.getItem('ADMIN_TOKEN')}` }\r\n            });\r\n\r\n            if (!res.ok) throw new Error('Download failed');\r\n\r\n            // Because it's a blob/json file, we fetch it and create an object URL\r\n            const blob = await res.blob();\r\n\r\n            // Native Electron Download Bridge\r\n            if (window.electronAPI?.saveFile) {\r\n                const text = await blob.text();\r\n                const saved = await window.electronAPI.saveFile(filename, text);\r\n                if (saved) setBackupMsg('Download complete');\r\n                else setBackupMsg('');\r\n                return;\r\n            }\r\n\r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.style.display = 'none';\r\n            a.href = url;\r\n            a.download = filename;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            window.URL.revokeObjectURL(url);\r\n            setBackupMsg('');\r\n        } catch (err) {\r\n            setBackupMsg('Error downloading backup');\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ padding: '2rem', height: '100%', overflowY: 'auto' }}>\r\n            <div className=\"animate-fade-in\" style={{ maxWidth: '1000px', margin: '0 auto' }}>\r\n\r\n                {/* Header */}\r\n                <div style={{ marginBottom: '2rem', display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n                    <div style={{\r\n                        width: '48px', height: '48px', borderRadius: '12px',\r\n                        background: 'var(--bg-tertiary)', color: 'var(--text-primary)',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                    }}>\r\n                        <IconSettings />\r\n                    </div>\r\n                    <div>\r\n                        <div style={{ color: 'var(--accent-color)', fontWeight: '700', fontSize: '0.75rem', letterSpacing: '0.1em', marginBottom: '0.2rem' }}>ADMINISTRATION</div>\r\n                        <h1 style={{ fontSize: '1.75rem', margin: 0 }}>System Settings</h1>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Tabs */}\r\n                <div style={{ display: 'flex', gap: '1rem', marginBottom: '2rem', borderBottom: '1px solid var(--border-color)' }}>\r\n                    <button\r\n                        onClick={() => setActiveTab('general')}\r\n                        style={{\r\n                            padding: '1rem 0.5rem', background: 'none', border: 'none',\r\n                            borderBottom: activeTab === 'general' ? '2px solid var(--accent-color)' : '2px solid transparent',\r\n                            color: activeTab === 'general' ? 'var(--accent-color)' : 'var(--text-secondary)',\r\n                            fontWeight: '700', cursor: 'pointer', fontSize: '0.9rem'\r\n                        }}\r\n                    >\r\n                        General & Interface\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setActiveTab('backup')}\r\n                        style={{\r\n                            padding: '1rem 0.5rem', background: 'none', border: 'none',\r\n                            borderBottom: activeTab === 'backup' ? '2px solid var(--accent-color)' : '2px solid transparent',\r\n                            color: activeTab === 'backup' ? 'var(--accent-color)' : 'var(--text-secondary)',\r\n                            fontWeight: '700', cursor: 'pointer', fontSize: '0.9rem'\r\n                        }}\r\n                    >\r\n                        Backup & Recovery\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setActiveTab('system')}\r\n                        style={{\r\n                            padding: '1rem 0.5rem', background: 'none', border: 'none',\r\n                            borderBottom: activeTab === 'system' ? '2px solid var(--accent-color)' : '2px solid transparent',\r\n                            color: activeTab === 'system' ? 'var(--accent-color)' : 'var(--text-secondary)',\r\n                            fontWeight: '700', cursor: 'pointer', fontSize: '0.9rem'\r\n                        }}\r\n                    >\r\n                        System Information\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"panel\" style={{ padding: '2.5rem', background: 'var(--bg-secondary)' }}>\r\n\r\n                    {/* --- GENERAL TAB --- */}\r\n                    {activeTab === 'general' && (\r\n                        <div className=\"animate-fade-in\">\r\n                            <h3 style={{ marginBottom: '1.5rem' }}>Interface Preferences</h3>\r\n\r\n                            <div style={{ marginBottom: '2.5rem', maxWidth: '500px' }}>\r\n                                <label style={labelStyle}>Theme Mode</label>\r\n                                <div style={{ display: 'flex', gap: '1rem' }}>\r\n                                    <button\r\n                                        onClick={() => theme !== 'light' && toggleTheme()}\r\n                                        style={{\r\n                                            flex: 1, padding: '1rem', borderRadius: '8px', border: '2px solid',\r\n                                            borderColor: theme === 'light' ? 'var(--accent-color)' : 'var(--border-color)',\r\n                                            background: theme === 'light' ? 'rgba(99, 102, 241, 0.1)' : 'transparent',\r\n                                            cursor: 'pointer'\r\n                                        }}\r\n                                    >\r\n                                        ΓÿÇ∩╕Å Light Mode\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => theme !== 'dark' && toggleTheme()}\r\n                                        style={{\r\n                                            flex: 1, padding: '1rem', borderRadius: '8px', border: '2px solid',\r\n                                            borderColor: theme === 'dark' ? 'var(--accent-color)' : 'var(--border-color)',\r\n                                            background: theme === 'dark' ? 'rgba(99, 102, 241, 0.1)' : 'transparent',\r\n                                            cursor: 'pointer', color: 'var(--text-primary)'\r\n                                        }}\r\n                                    >\r\n                                        ≡ƒîÖ Dark Mode\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div style={{ marginBottom: '2.5rem', maxWidth: '500px' }}>\r\n                                <label style={labelStyle}>Server Endpoint Configuration</label>\r\n                                <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={apiUrl}\r\n                                        readOnly\r\n                                        style={{\r\n                                            flex: 1, padding: '0.8rem', borderRadius: '8px',\r\n                                            border: '1px solid var(--border-color)', background: 'var(--bg-tertiary)',\r\n                                            color: 'var(--text-secondary)', fontFamily: 'monospace'\r\n                                        }}\r\n                                    />\r\n                                    <button\r\n                                        onClick={() => { const url = prompt(\"Enter new API URL:\", apiUrl); if (url) updateApiUrl(url); }}\r\n                                        className=\"btn btn-secondary\"\r\n                                    >\r\n                                        Edit\r\n                                    </button>\r\n                                </div>\r\n                                <p style={{ fontSize: '0.8rem', marginTop: '0.5rem', opacity: 0.6 }}>\r\n                                    Current connection endpoint for scanner data synchronization.\r\n                                </p>\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={async () => {\r\n                                    try {\r\n                                        await fetch(`${apiUrl}/api/logout`, { method: 'POST' });\r\n                                    } catch (e) { console.error('Logout err', e); }\r\n                                    localStorage.clear();\r\n                                    window.location.href = '/';\r\n                                }}\r\n                                style={{ color: 'var(--error-color)', background: 'none', border: '1px solid var(--error-color)', padding: '0.8rem 1.5rem', borderRadius: '8px', cursor: 'pointer', fontWeight: 'bold' }}\r\n                            >\r\n                                Terminate Session & Logout\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* --- BACKUP TAB --- */}\r\n                    {activeTab === 'backup' && (\r\n                        <div className=\"animate-fade-in\">\r\n                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))', gap: '1.5rem', marginBottom: '2rem' }}>\r\n\r\n                                {/* Auto Backup Config Card */}\r\n                                <div style={infoCardStyle}>\r\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.8rem', marginBottom: '1rem' }}>\r\n                                        <div style={{ width: '40px', height: '40px', borderRadius: '8px', background: 'rgba(99, 102, 241, 0.1)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'var(--accent-color)' }}>\r\n                                            <IconCloud />\r\n                                        </div>\r\n                                        <h3 style={{ margin: 0, fontSize: '1.2rem' }}>Auto-Backup Setup</h3>\r\n                                    </div>\r\n                                    <p style={{ fontSize: '0.85rem', color: 'var(--text-secondary)', marginBottom: '1.5rem', lineHeight: '1.5' }}>\r\n                                        System state is backed up automatically at <strong>11:00 PM daily</strong> and upon <strong>Admin Login/Logout</strong>. Choose where these files are saved.\r\n                                    </p>\r\n                                    <label style={labelStyle}>Target Directory Path</label>\r\n                                    <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.8rem' }}>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={backupPath}\r\n                                            onClick={async () => {\r\n                                                if (window.electronAPI?.selectDirectory) {\r\n                                                    const path = await window.electronAPI.selectDirectory();\r\n                                                    if (path) setBackupPath(path);\r\n                                                }\r\n                                            }}\r\n                                            onChange={e => setBackupPath(e.target.value)}\r\n                                            placeholder=\"./backups (Click to browse)\"\r\n                                            style={{\r\n                                                flex: 1, padding: '0.8rem', borderRadius: '8px',\r\n                                                border: '1px solid var(--border-color)', background: 'var(--bg-primary)',\r\n                                                color: 'var(--text-primary)', fontFamily: 'monospace',\r\n                                                cursor: window.electronAPI ? 'pointer' : 'text'\r\n                                            }}\r\n                                        />\r\n                                        <button onClick={handleSavePath} className=\"btn btn-primary\" style={{ padding: '0 1rem' }}>Save</button>\r\n                                    </div>\r\n                                    <p style={{ fontSize: '0.75rem', color: 'var(--text-secondary)', opacity: 0.7, margin: 0 }}>\r\n                                        Supports absolute paths (e.g. <code>C:/Backups</code>) or relative paths. Ensure the server has write permissions.\r\n                                    </p>\r\n                                </div>\r\n\r\n                                {/* Manual Action Card */}\r\n                                <div style={infoCardStyle}>\r\n                                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.8rem', marginBottom: '1rem' }}>\r\n                                        <div style={{ width: '40px', height: '40px', borderRadius: '8px', background: 'rgba(99, 102, 241, 0.1)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'var(--accent-color)' }}>\r\n                                            <IconSettings />\r\n                                        </div>\r\n                                        <h3 style={{ margin: 0, fontSize: '1.2rem' }}>Manual Actions</h3>\r\n                                    </div>\r\n                                    <p style={{ fontSize: '0.85rem', color: 'var(--text-secondary)', marginBottom: '1.5rem', lineHeight: '1.5' }}>\r\n                                        Create an instant snapshot of your current database state, or restore the system from an existing <code>.json</code> backup file.\r\n                                    </p>\r\n                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n                                        <button onClick={handleCreateBackup} className=\"btn btn-primary\" style={{ width: '100%', padding: '1rem', display: 'flex', justifyContent: 'center', gap: '0.5rem', fontWeight: 'bold' }}>\r\n                                            <IconCloud /> Create Snapshot Now\r\n                                        </button>\r\n\r\n                                        <div style={{ position: 'relative', borderRadius: '8px', border: '2px dashed var(--accent-color)', background: 'rgba(99, 102, 241, 0.05)', transition: 'all 0.2s ease', overflow: 'hidden' }}>\r\n                                            <input\r\n                                                type=\"file\"\r\n                                                accept=\".json\"\r\n                                                onChange={handleImportBackup}\r\n                                                style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', opacity: 0, cursor: 'pointer', zIndex: 10 }}\r\n                                            />\r\n                                            <div style={{ padding: '1rem', textAlign: 'center', color: 'var(--accent-color)', fontWeight: 'bold', fontSize: '0.9rem', pointerEvents: 'none' }}>\r\n                                                ≡ƒôÑ Click or Drop .json to Import/Restore\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {backupMsg && (\r\n                                <div style={{ background: 'var(--bg-tertiary)', padding: '1rem', borderRadius: '8px', marginBottom: '2rem', borderLeft: '4px solid var(--accent-color)', fontWeight: '600' }}>\r\n                                    {backupMsg}\r\n                                </div>\r\n                            )}\r\n\r\n                            <h3 style={{ margin: '0 0 1rem', paddingBottom: '0.8rem', borderBottom: '1px solid var(--border-color)' }}>Snapshot History</h3>\r\n                            {loadingBackups ? <div style={{ opacity: 0.5 }}>Loading archives...</div> : (\r\n                                <div style={{ background: 'var(--bg-primary)', borderRadius: '12px', overflow: 'hidden', border: '1px solid var(--border-color)' }}>\r\n                                    {backups.length === 0 ? (\r\n                                        <div style={{ padding: '2rem', textAlign: 'center', opacity: 0.5 }}>No backups found in configured directory.</div>\r\n                                    ) : (\r\n                                        <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                                            <tbody>\r\n                                                {backups.map((filename, i) => {\r\n                                                    const match = filename.match(/^backup-([A-Z]+)-(.*)\\.json$/);\r\n                                                    let type = 'BACKUP';\r\n                                                    let displayDate = filename;\r\n\r\n                                                    if (match) {\r\n                                                        type = match[1];\r\n                                                        const [datePart, timePart] = match[2].split('T');\r\n                                                        if (datePart && timePart) {\r\n                                                            const tk = timePart.split('-');\r\n                                                            if (tk.length >= 3) {\r\n                                                                try {\r\n                                                                    const dObj = new Date(`${datePart}T${tk[0]}:${tk[1]}:${tk[2]}.${tk[3]}`);\r\n                                                                    if (!isNaN(dObj.getTime())) displayDate = dObj.toLocaleString();\r\n                                                                    else displayDate = `${datePart} ${tk[0]}:${tk[1]}`;\r\n                                                                } catch (e) {\r\n                                                                    console.debug(e);\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n\r\n                                                    return (\r\n                                                        <tr key={i} style={{ borderBottom: '1px solid var(--border-color)' }}>\r\n                                                            <td style={{ padding: '1rem', width: '80px' }}>\r\n                                                                <div style={{ background: 'var(--bg-tertiary)', padding: '0.4rem 0.6rem', borderRadius: '6px', fontSize: '0.7rem', fontWeight: 'bold', textAlign: 'center', color: 'var(--accent-color)' }}>\r\n                                                                    {type}\r\n                                                                </div>\r\n                                                            </td>\r\n                                                            <td style={{ padding: '1rem' }}>\r\n                                                                <div style={{ fontWeight: '700', fontSize: '1rem', marginBottom: '0.3rem', color: 'var(--text-primary)' }}>{displayDate}</div>\r\n                                                                <div style={{ fontFamily: 'monospace', fontSize: '0.75rem', color: 'var(--text-secondary)', opacity: 0.7 }}>{filename}</div>\r\n                                                            </td>\r\n                                                            <td style={{ padding: '1rem', textAlign: 'right' }}>\r\n                                                                <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end' }}>\r\n                                                                    <button\r\n                                                                        onClick={() => handleDownload(filename)}\r\n                                                                        style={{ background: 'none', border: 'none', color: 'var(--accent-color)', cursor: 'pointer', fontWeight: '600', fontSize: '0.85rem' }}\r\n                                                                    >\r\n                                                                        Download\r\n                                                                    </button>\r\n                                                                    <button\r\n                                                                        onClick={() => handleRestore(filename)}\r\n                                                                        style={{ background: 'none', border: 'none', color: 'var(--error-color)', cursor: 'pointer', fontWeight: '600', fontSize: '0.85rem' }}\r\n                                                                    >\r\n                                                                        Restore\r\n                                                                    </button>\r\n                                                                </div>\r\n                                                            </td>\r\n                                                        </tr>\r\n                                                    )\r\n                                                })}\r\n                                            </tbody>\r\n                                        </table>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* --- SYSTEM TAB --- */}\r\n                    {activeTab === 'system' && (\r\n                        <div className=\"animate-fade-in\">\r\n                            <h3 style={{ marginBottom: '1.5rem' }}>Environment Status</h3>\r\n\r\n                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(280px, 1fr))', gap: '1.5rem' }}>\r\n                                <div style={infoCardStyle}>\r\n                                    <span style={{ fontSize: '0.8rem', opacity: 0.6, textTransform: 'uppercase', marginBottom: '0.5rem', display: 'block' }}>Network</span>\r\n                                    <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: 'monospace' }}>{serverIp}</div>\r\n                                    <div style={{ fontSize: '0.85rem', color: 'var(--success-color)', marginTop: '0.5rem' }}>ΓùÅ Online (HTTPS)</div>\r\n                                </div>\r\n\r\n                                <div style={infoCardStyle}>\r\n                                    <span style={{ fontSize: '0.8rem', opacity: 0.6, textTransform: 'uppercase', marginBottom: '0.5rem', display: 'block' }}>Scanner Nodes</span>\r\n                                    <div style={{ fontSize: '1.5rem', fontWeight: '800' }}>{scanners.length} <span style={{ fontSize: '1rem', opacity: 0.5 }}>Active</span></div>\r\n                                    <div style={{ fontSize: '0.85rem', marginTop: '0.5rem', opacity: 0.7 }}>Connected Devices</div>\r\n                                </div>\r\n\r\n                                <div style={infoCardStyle}>\r\n                                    <span style={{ fontSize: '0.8rem', opacity: 0.6, textTransform: 'uppercase', marginBottom: '0.5rem', display: 'block' }}>Database</span>\r\n                                    <div style={{ fontSize: '1.5rem', fontWeight: '800' }}>MongoDB</div>\r\n                                    <div style={{ fontSize: '0.85rem', color: 'var(--success-color)', marginTop: '0.5rem' }}>ΓùÅ Connected</div>\r\n                                </div>\r\n\r\n                                <div style={infoCardStyle}>\r\n                                    <span style={{ fontSize: '0.8rem', opacity: 0.6, textTransform: 'uppercase', marginBottom: '0.5rem', display: 'block' }}>System Version</span>\r\n                                    <div style={{ fontSize: '1.5rem', fontWeight: '800' }}>v2.4.0</div>\r\n                                    <div style={{ fontSize: '0.85rem', marginTop: '0.5rem', opacity: 0.7 }}>Build 2026.02</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst labelStyle = { display: 'block', fontSize: '0.75rem', fontWeight: '700', color: 'var(--text-secondary)', textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '0.8rem' };\r\nconst infoCardStyle = { background: 'var(--bg-tertiary)', padding: '1.5rem', borderRadius: '12px', border: '1px solid var(--border-color)' };\r\n\r\nexport default Settings;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\varun\\OneDrive\\Pictures\\Documents\\GitHub\\textile-stock-management\\desktop\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
